<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Components &#8212; Connector  documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Models" href="api_backend.html" />
    <link rel="prev" title="Configuring channels and the job runner" href="../guides/jobrunner.html" />

<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-7628916-3', 'odoo-connector.com');
  ga('send', 'pageview');
</script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          Odoo Connector</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
  <li class="dropdown">
    <a role="button"
       id="dLabelTranslations"
       data-toggle="dropdown"
       data-target="#"
       href="#">Translations<b class="caret"></b></a>
    <ul class="dropdown-menu"
        role="menu"
        aria-labelledby="dLabelTranslations">
      <li><a class="reference" href="http://odoo-connector.com/12.0">English</a></li>
      <li><a class="reference" href="http://odoo-connector.com/12.0/fr">French</a></li>
    </ul>
  </li>
  <li class="dropdown">
    <a role="button"
       id="dLabelVersions"
       data-toggle="dropdown"
       data-target="#"
       href="#">Version<b class="caret"></b></a>
    <ul class="dropdown-menu"
        role="menu"
        aria-labelledby="dLabeVersions">
      <li><a class="reference" href="http://odoo-connector.com/8.0">8.0</a></li>
      <li><a class="reference" href="http://odoo-connector.com/9.0">9.0</a></li>
      <li><a class="reference" href="http://odoo-connector.com/10.0">10.0</a></li>
      <li><a class="reference" href="http://odoo-connector.com/11.0">11.0</a></li>
      <li><a class="reference" href="http://odoo-connector.com/">13.0</a></li>
    </ul>
  </li>
  
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../guides/migration_guide.html">Migration Guide to the new Connector API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../guides/migration_guide.html#migrating-jobs">Migrating Jobs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/migration_guide.html#migrating-events">Migrating Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/migration_guide.html#migrating-components">Migrating Components</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../guides/code_overview.html">Code Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../guides/code_overview.html#trigger-and-listen-an-event">Trigger and listen an event</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/code_overview.html#delay-an-asynchronous-job">Delay an Asynchronous Job</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/code_overview.html#work-with-components">Work with components</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../guides/concepts.html">Connector Concepts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../guides/concepts.html#events">Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/concepts.html#jobs-queue">Jobs Queue</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/concepts.html#backend">Backend</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/concepts.html#workcontext">WorkContext</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/concepts.html#component">Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/concepts.html#bindings">Bindings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/concepts.html#checkpoint">Checkpoint</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../guides/bootstrap_connector.html">Boostrapping a connector</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../guides/bootstrap_connector.html#odoo-manifest">Odoo Manifest</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/bootstrap_connector.html#backend-model">Backend Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/bootstrap_connector.html#abstract-binding">Abstract Binding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/bootstrap_connector.html#components">Components</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../guides/jobrunner.html">Configuring channels and the job runner</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../guides/jobrunner.html#what-is-the-job-runner">What is the job runner?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/jobrunner.html#how-does-it-work">How does it work?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/jobrunner.html#how-to-use-it">How to use it?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/jobrunner.html#caveat">Caveat</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/jobrunner.html#what-is-a-channel">What is a channel?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/jobrunner.html#how-to-configure-channels">How to configure Channels?</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Components</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-connector.components.core">Core Components</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-connector.components.binder">Connector Components</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-odoo.addons.component.models.collection">Components Collection Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-odoo.addons.component.exception">Components Exceptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#components-internals">Components Internals</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api_backend.html">Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api_backend.html#backend-model">Backend Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="api_backend.html#binding-model">Binding Model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api_event.html">Events</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api_event.html#module-odoo.addons.component_event.components.event">Components</a></li>
<li class="toctree-l2"><a class="reference internal" href="api_event.html#module-odoo.addons.component_event.models.base">Odoo Models Extensions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api_queue.html">Queue</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api_queue.html#module-odoo.addons.queue_job.models.base">Models</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api_exception.html">Exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="api_channels.html">Channels</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../project/contribute.html">Contribute</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../project/contribute.html#want-to-start-a-new-connector">Want to start a new connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="../project/contribute.html#creating-or-maintaining-a-translation-of-this-doc">Creating or maintaining a translation of this doc</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../project/contributors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../project/contributors.html#financial-contributors">Financial Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../project/license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../project/roadmap.html">Roadmap</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Components</a><ul>
<li><a class="reference internal" href="#module-connector.components.core">Core Components</a><ul>
<li><a class="reference internal" href="#base-component">Base Component</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-connector.components.binder">Connector Components</a><ul>
<li><a class="reference internal" href="#binders">Binders</a></li>
<li><a class="reference internal" href="#mappers">Mappers</a></li>
<li><a class="reference internal" href="#backend-adapter">Backend Adapter</a></li>
<li><a class="reference internal" href="#synchronizer">Synchronizer</a></li>
<li><a class="reference internal" href="#listeners">Listeners</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-odoo.addons.component.models.collection">Components Collection Model</a><ul>
<li><a class="reference internal" href="#collection-model">Collection Model</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-odoo.addons.component.exception">Components Exceptions</a></li>
<li><a class="reference internal" href="#components-internals">Components Internals</a><ul>
<li><a class="reference internal" href="#core">Core</a></li>
<li><a class="reference internal" href="#components-builder">Components Builder</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            

            
              
                
  <li>
    <a href="../guides/jobrunner.html" title="Previous Chapter: Configuring channels and the job runner"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Configuring c...</span>
    </a>
  </li>
  <li>
    <a href="api_backend.html" title="Next Chapter: Models"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Models &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="section" id="components">
<span id="api-component"></span><h1>Components<a class="headerlink" href="#components" title="Permalink to this headline">¶</a></h1>
<p>Components are the blocks allowing to build a flexible and
well decoupled code. They are based on the <code class="docutils literal notranslate"><span class="pre">component</span></code> addon, which
can as well be used separately.</p>
<div class="section" id="module-connector.components.core">
<span id="core-components"></span><h2>Core Components<a class="headerlink" href="#module-connector.components.core" title="Permalink to this headline">¶</a></h2>
<div class="section" id="base-component">
<h3>Base Component<a class="headerlink" href="#base-component" title="Permalink to this headline">¶</a></h3>
<p>The connector proposes a ‘base’ Component, which can be used in
the <code class="docutils literal notranslate"><span class="pre">_inherit</span></code> of your own components.  This is not a
requirement.  It is already inherited by every component
provided by the Connector.</p>
<p>Components are organized according to different usages.  The connector suggests
5 main kinds of Components. Each might have a few different usages.  You can be
as creative as you want when it comes to creating new ones though.</p>
<p>One “usage” is responsible for a specific work, and alongside with the
collection (the backend) and the model, the usage will be used to find the
needed component for a task.</p>
<p>Some of the Components have an implementation in the <code class="docutils literal notranslate"><span class="pre">Connector</span></code> addon, but
some are empty shells that need to be implemented in the different connectors.</p>
<p>The usual categories are:</p>
<dl class="docutils">
<dt><a class="reference internal" href="#connector.components.binder.Binder" title="connector.components.binder.Binder"><code class="xref py py-class docutils literal notranslate"><span class="pre">Binder</span></code></a></dt><dd><p>The <code class="docutils literal notranslate"><span class="pre">binders</span></code> give the external ID or Odoo ID from respectively an
Odoo ID or an external ID. A default implementation is available.</p>
<p>Most common usages:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">binder</span></code></li>
</ul>
</dd>
<dt><a class="reference internal" href="#connector.components.mapper.Mapper" title="connector.components.mapper.Mapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapper</span></code></a></dt><dd><p>The <code class="docutils literal notranslate"><span class="pre">mappers</span></code> transform a external record into an Odoo record or
conversely.</p>
<p>Most common usages:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">import.mapper</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">export.mapper</span></code></li>
</ul>
</dd>
<dt><a class="reference internal" href="#connector.components.backend_adapter.BackendAdapter" title="connector.components.backend_adapter.BackendAdapter"><code class="xref py py-class docutils literal notranslate"><span class="pre">BackendAdapter</span></code></a></dt><dd><p>The <code class="docutils literal notranslate"><span class="pre">backend.adapters</span></code> implements the discussion with the <code class="docutils literal notranslate"><span class="pre">backend's</span></code>
APIs. They usually adapt their APIs to a common interface (CRUD).</p>
<p>Most common usages:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">backend.adapter</span></code></li>
</ul>
</dd>
<dt><a class="reference internal" href="#connector.components.synchronizer.Synchronizer" title="connector.components.synchronizer.Synchronizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Synchronizer</span></code></a></dt><dd><p>A <code class="docutils literal notranslate"><span class="pre">synchronizer</span></code> is the main piece of a synchronization.  It
orchestrates the flow of a synchronization and use the other
Components</p>
<p>Most common usages:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">record.importer</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">record.exporter</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">batch.importer</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">batch.exporter</span></code></li>
</ul>
</dd>
</dl>
<p>The possibilities for components do not stop there, look at the
<a class="reference internal" href="#connector.components.locker.RecordLocker" title="connector.components.locker.RecordLocker"><code class="xref py py-class docutils literal notranslate"><span class="pre">RecordLocker</span></code></a> for an example of
single-purpose, decoupled component.</p>
<dl class="py class">
<dt id="connector.components.core.BaseConnectorComponent">
<em class="property"><span class="pre">class</span> </em><code class="descclassname"><span class="pre">connector.components.core.</span></code><code class="descname"><span class="pre">BaseConnectorComponent</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">work_context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/core.html#BaseConnectorComponent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.core.BaseConnectorComponent" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#odoo.addons.component.core.AbstractComponent" title="odoo.addons.component.core.AbstractComponent"><code class="xref py py-class docutils literal notranslate"><span class="pre">odoo.addons.component.core.AbstractComponent</span></code></a></p>
<p>Base component for the connector</p>
<p>Is inherited by every components of the Connector (Binder, Mapper, …)
and adds a few methods which are of common usage in the connectors.</p>
<dl class="py attribute">
<dt id="connector.components.core.BaseConnectorComponent._name">
<code class="descname"><span class="pre">_name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'base.connector'</span></em><a class="headerlink" href="#connector.components.core.BaseConnectorComponent._name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the component</p>
</dd></dl>

<dl class="py method">
<dt id="connector.components.core.BaseConnectorComponent.backend_record">
<em class="property"><span class="pre">property</span> </em><code class="descname"><span class="pre">backend_record</span></code><a class="headerlink" href="#connector.components.core.BaseConnectorComponent.backend_record" title="Permalink to this definition">¶</a></dt>
<dd><p>Backend record we are working with</p>
</dd></dl>

<dl class="py method">
<dt id="connector.components.core.BaseConnectorComponent.binder_for">
<code class="descname"><span class="pre">binder_for</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/core.html#BaseConnectorComponent.binder_for"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.core.BaseConnectorComponent.binder_for" title="Permalink to this definition">¶</a></dt>
<dd><p>Shortcut to get Binder for a model</p>
<p>Equivalent to: <code class="docutils literal notranslate"><span class="pre">self.component(usage='binder',</span> <span class="pre">model_name='xxx')</span></code></p>
</dd></dl>

<dl class="py method">
<dt id="connector.components.core.BaseConnectorComponent.advisory_lock_or_retry">
<code class="descname"><span class="pre">advisory_lock_or_retry</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">lock</span></span></em>, <em><span class="n"><span class="pre">retry_seconds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/core.html#BaseConnectorComponent.advisory_lock_or_retry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.core.BaseConnectorComponent.advisory_lock_or_retry" title="Permalink to this definition">¶</a></dt>
<dd><p>Acquire a Postgres transactional advisory lock or retry job</p>
<p>When the lock cannot be acquired, it raises a
<code class="xref py py-exc docutils literal notranslate"><span class="pre">odoo.addons.queue_job.exception.RetryableJobError</span></code> so the job
is retried after n <code class="docutils literal notranslate"><span class="pre">retry_seconds</span></code>.</p>
<p>Usage example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lock_name</span> <span class="o">=</span> <span class="s1">&#39;import_record(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">backend_record</span><span class="o">.</span><span class="n">_name</span><span class="p">,</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">backend_record</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">_name</span><span class="p">,</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">external_id</span><span class="p">,</span>
<span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">advisory_lock_or_retry</span><span class="p">(</span><span class="n">lock_name</span><span class="p">,</span> <span class="n">retry_seconds</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>See <code class="xref py py-func docutils literal notranslate"><span class="pre">odoo.addons.connector.connector.pg_try_advisory_lock()</span></code> for
details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>lock</strong> – The lock name. Can be anything convertible to a
string.  It needs to represent what should not be synchronized
concurrently, usually the string will contain at least: the
action, the backend name, the backend id, the model name, the
external id</li>
<li><strong>retry_seconds</strong> – number of seconds after which a job should
be retried when the lock cannot be acquired.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-connector.components.binder">
<span id="connector-components"></span><h2>Connector Components<a class="headerlink" href="#module-connector.components.binder" title="Permalink to this headline">¶</a></h2>
<div class="section" id="binders">
<h3>Binders<a class="headerlink" href="#binders" title="Permalink to this headline">¶</a></h3>
<p>Binders are components that know how to find the external ID for an
Odoo ID, how to find the Odoo ID for an external ID and how to
create the binding between them.</p>
<dl class="py class">
<dt id="connector.components.binder.Binder">
<em class="property"><span class="pre">class</span> </em><code class="descclassname"><span class="pre">connector.components.binder.</span></code><code class="descname"><span class="pre">Binder</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">work_context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/binder.html#Binder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.binder.Binder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#odoo.addons.component.core.AbstractComponent" title="odoo.addons.component.core.AbstractComponent"><code class="xref py py-class docutils literal notranslate"><span class="pre">odoo.addons.component.core.AbstractComponent</span></code></a></p>
<p>For one record of a model, capable to find an external or
internal id, or create the binding (link) between them</p>
<p>This is a default implementation that can be inherited or reimplemented
in the connectors.</p>
<p>This implementation assumes that binding models are <code class="docutils literal notranslate"><span class="pre">_inherits</span></code> of
the models they are binding.</p>
<dl class="py attribute">
<dt id="connector.components.binder.Binder._name">
<code class="descname"><span class="pre">_name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'base.binder'</span></em><a class="headerlink" href="#connector.components.binder.Binder._name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the component</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.binder.Binder._inherit">
<code class="descname"><span class="pre">_inherit</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'base.connector'</span></em><a class="headerlink" href="#connector.components.binder.Binder._inherit" title="Permalink to this definition">¶</a></dt>
<dd><p>Name or list of names of the component(s) to inherit from</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.binder.Binder._usage">
<code class="descname"><span class="pre">_usage</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'binder'</span></em><a class="headerlink" href="#connector.components.binder.Binder._usage" title="Permalink to this definition">¶</a></dt>
<dd><p>Component purpose (‘import.mapper’, …).</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.binder.Binder._external_field">
<code class="descname"><span class="pre">_external_field</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'external_id'</span></em><a class="headerlink" href="#connector.components.binder.Binder._external_field" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="connector.components.binder.Binder._backend_field">
<code class="descname"><span class="pre">_backend_field</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'backend_id'</span></em><a class="headerlink" href="#connector.components.binder.Binder._backend_field" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="connector.components.binder.Binder._odoo_field">
<code class="descname"><span class="pre">_odoo_field</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'odoo_id'</span></em><a class="headerlink" href="#connector.components.binder.Binder._odoo_field" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="connector.components.binder.Binder._sync_date_field">
<code class="descname"><span class="pre">_sync_date_field</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'sync_date'</span></em><a class="headerlink" href="#connector.components.binder.Binder._sync_date_field" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="connector.components.binder.Binder.to_internal">
<code class="descname"><span class="pre">to_internal</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">external_id</span></span></em>, <em><span class="n"><span class="pre">unwrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/binder.html#Binder.to_internal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.binder.Binder.to_internal" title="Permalink to this definition">¶</a></dt>
<dd><p>Give the Odoo recordset for an external ID</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>external_id</strong> – external ID for which we want
the Odoo ID</li>
<li><strong>unwrap</strong> – if True, returns the normal record
else return the binding record</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">a recordset, depending on the value of unwrap,
or an empty recordset if the external_id is not mapped</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">recordset</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="connector.components.binder.Binder.to_external">
<code class="descname"><span class="pre">to_external</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">binding</span></span></em>, <em><span class="n"><span class="pre">wrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/binder.html#Binder.to_external"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.binder.Binder.to_external" title="Permalink to this definition">¶</a></dt>
<dd><p>Give the external ID for an Odoo binding ID</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>binding</strong> – Odoo binding for which we want the external id</li>
<li><strong>wrap</strong> – if True, binding is a normal record, the
method will search the corresponding binding and return
the external id of the binding</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">external ID of the record</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="connector.components.binder.Binder.bind">
<code class="descname"><span class="pre">bind</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">external_id</span></span></em>, <em><span class="n"><span class="pre">binding</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/binder.html#Binder.bind"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.binder.Binder.bind" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the link between an external ID and an Odoo ID</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>external_id</strong> – external id to bind</li>
<li><strong>binding</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Odoo record to bind</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="connector.components.binder.Binder.unwrap_binding">
<code class="descname"><span class="pre">unwrap_binding</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">binding</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/binder.html#Binder.unwrap_binding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.binder.Binder.unwrap_binding" title="Permalink to this definition">¶</a></dt>
<dd><p>For a binding record, gives the normal record.</p>
<p>Example: when called with a <code class="docutils literal notranslate"><span class="pre">magento.product.product</span></code> id,
it will return the corresponding <code class="docutils literal notranslate"><span class="pre">product.product</span></code> id.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>browse</strong> – when True, returns a browse_record instance
rather than an ID</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="connector.components.binder.Binder.unwrap_model">
<code class="descname"><span class="pre">unwrap_model</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/binder.html#Binder.unwrap_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.binder.Binder.unwrap_model" title="Permalink to this definition">¶</a></dt>
<dd><p>For a binding model, gives the normal model.</p>
<p>Example: when called on a binder for <code class="docutils literal notranslate"><span class="pre">magento.product.product</span></code>,
it will return <code class="docutils literal notranslate"><span class="pre">product.product</span></code>.</p>
</dd></dl>

</dd></dl>

</div>
<span class="target" id="module-connector.components.mapper"></span><div class="section" id="mappers">
<h3>Mappers<a class="headerlink" href="#mappers" title="Permalink to this headline">¶</a></h3>
<p>Mappers are the components responsible to transform
external records into Odoo records and conversely.</p>
<dl class="py class">
<dt id="connector.components.mapper.Mapper">
<em class="property"><span class="pre">class</span> </em><code class="descclassname"><span class="pre">connector.components.mapper.</span></code><code class="descname"><span class="pre">Mapper</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">work</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/mapper.html#Mapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.mapper.Mapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#odoo.addons.component.core.AbstractComponent" title="odoo.addons.component.core.AbstractComponent"><code class="xref py py-class docutils literal notranslate"><span class="pre">odoo.addons.component.core.AbstractComponent</span></code></a></p>
<p>A Mapper translates an external record to an Odoo record and
conversely. The output of a Mapper is a <code class="docutils literal notranslate"><span class="pre">dict</span></code>.</p>
<p>3 types of mappings are supported:</p>
<dl class="docutils">
<dt>Direct Mappings</dt><dd><p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">direct</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;source&#39;</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">)]</span>
</pre></div>
</div>
<p>Here, the <code class="docutils literal notranslate"><span class="pre">source</span></code> field will be copied in the <code class="docutils literal notranslate"><span class="pre">target</span></code> field.</p>
<p>A modifier can be used in the source item.
The modifier will be applied to the source field before being
copied in the target field.
It should be a closure function respecting this idiom:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">a_function</span><span class="p">(</span><span class="n">field</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; ``field`` is the name of the source field.</span>

<span class="sd">        Naming the arg: ``field`` is required for the conversion&#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">modifier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">,</span> <span class="n">to_attr</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; self is the current Mapper,</span>
<span class="sd">            record is the current record to map,</span>
<span class="sd">            to_attr is the target field&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">record</span><span class="p">[</span><span class="n">field</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">modifier</span>
</pre></div>
</div>
<p>And used like that:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">direct</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="n">a_function</span><span class="p">(</span><span class="s1">&#39;source&#39;</span><span class="p">),</span> <span class="s1">&#39;target&#39;</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>
</div>
<p>A more concrete example of modifier:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">conv_type</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Convert the source field to a defined ``conv_type``</span>
<span class="sd">    (ex. str) before returning it&#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">modifier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">,</span> <span class="n">to_attr</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">record</span><span class="p">[</span><span class="n">field</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">conv_type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">modifier</span>
</pre></div>
</div>
<p>And used like that:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">direct</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="n">convert</span><span class="p">(</span><span class="s1">&#39;myfield&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span> <span class="s1">&#39;target_field&#39;</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>
</div>
<p>More examples of modifiers:</p>
<ul class="simple">
<li><a class="reference internal" href="#connector.components.mapper.convert" title="connector.components.mapper.convert"><code class="xref py py-func docutils literal notranslate"><span class="pre">convert()</span></code></a></li>
<li><a class="reference internal" href="#connector.components.mapper.m2o_to_external" title="connector.components.mapper.m2o_to_external"><code class="xref py py-func docutils literal notranslate"><span class="pre">m2o_to_external()</span></code></a></li>
<li><a class="reference internal" href="#connector.components.mapper.external_to_m2o" title="connector.components.mapper.external_to_m2o"><code class="xref py py-func docutils literal notranslate"><span class="pre">external_to_m2o()</span></code></a></li>
</ul>
</dd>
<dt>Method Mappings</dt><dd><p>A mapping method allows to execute arbitrary code and return one
or many fields:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@mapping</span>
<span class="k">def</span> <span class="nf">compute_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>
    <span class="c1"># compute some state, using the ``record`` or not</span>
    <span class="n">state</span> <span class="o">=</span> <span class="s1">&#39;pending&#39;</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;state&#39;</span><span class="p">:</span> <span class="n">state</span><span class="p">}</span>
</pre></div>
</div>
<p>We can also specify that a mapping methods should be applied
only when an object is created, and never applied on further
updates:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@only_create</span>
<span class="nd">@mapping</span>
<span class="k">def</span> <span class="nf">default_warehouse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>
    <span class="c1"># get default warehouse</span>
    <span class="n">warehouse_id</span> <span class="o">=</span> <span class="o">...</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;warehouse_id&#39;</span><span class="p">:</span> <span class="n">warehouse_id</span><span class="p">}</span>
</pre></div>
</div>
</dd>
<dt>Submappings</dt><dd><p>When a record contains sub-items, like the lines of a sales order,
we can convert the children using another Mapper:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">children</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;items&#39;</span><span class="p">,</span> <span class="s1">&#39;line_ids&#39;</span><span class="p">,</span> <span class="s1">&#39;model.name&#39;</span><span class="p">)]</span>
</pre></div>
</div>
<p>It allows to create the sales order and all its lines with the
same call to <code class="xref py py-meth docutils literal notranslate"><span class="pre">odoo.models.BaseModel.create()</span></code>.</p>
<p>When using <code class="docutils literal notranslate"><span class="pre">children</span></code> for items of a record, we need to create
a <a class="reference internal" href="#connector.components.mapper.Mapper" title="connector.components.mapper.Mapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapper</span></code></a> for the model of the items, and optionally a
<a class="reference internal" href="#connector.components.mapper.MapChild" title="connector.components.mapper.MapChild"><code class="xref py py-class docutils literal notranslate"><span class="pre">MapChild</span></code></a>.</p>
</dd>
</dl>
<p>Usage of a Mapper:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mapper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">component</span><span class="p">(</span><span class="n">usage</span><span class="o">=</span><span class="s1">&#39;mapper&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">map_record</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="n">map_record</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">values</span> <span class="o">=</span> <span class="n">map_record</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">values</span> <span class="o">=</span> <span class="n">map_record</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">only_create</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">values</span> <span class="o">=</span> <span class="n">map_record</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;street&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>Example of making ‘children’ records as ‘create_only’:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">FooSaleOrderMapper</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;foo.sale.order.import.mapper&#39;</span>
    <span class="n">_inherit</span> <span class="o">=</span> <span class="s1">&#39;foo.import.mapper&#39;</span>
    <span class="n">_apply_on</span> <span class="o">=</span> <span class="s1">&#39;foo.sale.order&#39;</span>

    <span class="n">children</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;items&#39;</span><span class="p">,</span> <span class="s1">&#39;line_ids&#39;</span><span class="p">,</span> <span class="s1">&#39;foo.sale.order.line&#39;</span><span class="p">)]</span>


<span class="k">class</span> <span class="nc">SaleLineMapChild</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;foo.sale.line.import.map.child&#39;</span>
    <span class="n">_inherit</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;foo.connector&#39;</span><span class="p">,</span> <span class="s1">&#39;base.map.child.import&#39;</span><span class="p">]</span>
    <span class="n">_apply_on</span> <span class="o">=</span> <span class="s1">&#39;foo.sale.order.line&#39;</span>

    <span class="k">def</span> <span class="nf">skip_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">map_record</span><span class="p">):</span>
        <span class="n">record</span> <span class="o">=</span> <span class="n">map_record</span><span class="o">.</span><span class="n">source</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">record</span><span class="p">[</span><span class="s1">&#39;attributes&#39;</span><span class="p">][</span><span class="s1">&#39;quantity&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">get_item_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">map_record</span><span class="p">,</span> <span class="n">to_attr</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">map_record</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
        <span class="n">binder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binder_for</span><span class="p">()</span>
        <span class="n">binding</span> <span class="o">=</span> <span class="n">binder</span><span class="o">.</span><span class="n">to_internal</span><span class="p">(</span><span class="n">map_record</span><span class="o">.</span><span class="n">source</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">binding</span><span class="p">:</span>
            <span class="c1"># already exists, keeps the id</span>
            <span class="n">values</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">binding</span><span class="o">.</span><span class="n">id</span>
        <span class="k">return</span> <span class="n">values</span>

    <span class="k">def</span> <span class="nf">format_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items_values</span><span class="p">):</span>
        <span class="c1"># if we already have an ID (found in get_item_values())</span>
        <span class="c1"># we change the command to update the existing record</span>
        <span class="n">items</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items_values</span><span class="p">[:]:</span>
            <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">):</span>
                <span class="n">binding_id</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
                <span class="c1"># update the record</span>
                <span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">binding_id</span><span class="p">,</span> <span class="n">item</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># create the record</span>
                <span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">item</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">items</span>
</pre></div>
</div>
<dl class="py attribute">
<dt id="connector.components.mapper.Mapper._name">
<code class="descname"><span class="pre">_name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'base.mapper'</span></em><a class="headerlink" href="#connector.components.mapper.Mapper._name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the component</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.mapper.Mapper._inherit">
<code class="descname"><span class="pre">_inherit</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'base.connector'</span></em><a class="headerlink" href="#connector.components.mapper.Mapper._inherit" title="Permalink to this definition">¶</a></dt>
<dd><p>Name or list of names of the component(s) to inherit from</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.mapper.Mapper._usage">
<code class="descname"><span class="pre">_usage</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'mapper'</span></em><a class="headerlink" href="#connector.components.mapper.Mapper._usage" title="Permalink to this definition">¶</a></dt>
<dd><p>Component purpose (‘import.mapper’, …).</p>
</dd></dl>

<dl class="py method">
<dt id="connector.components.mapper.Mapper.map_methods">
<em class="property"><span class="pre">property</span> </em><code class="descname"><span class="pre">map_methods</span></code><a class="headerlink" href="#connector.components.mapper.Mapper.map_methods" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield all the methods decorated with <code class="docutils literal notranslate"><span class="pre">&#64;mapping</span></code></p>
</dd></dl>

<dl class="py method">
<dt id="connector.components.mapper.Mapper.options">
<em class="property"><span class="pre">property</span> </em><code class="descname"><span class="pre">options</span></code><a class="headerlink" href="#connector.components.mapper.Mapper.options" title="Permalink to this definition">¶</a></dt>
<dd><p>Options can be accessed in the mapping methods with
<code class="docutils literal notranslate"><span class="pre">self.options</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="connector.components.mapper.Mapper.changed_by_fields">
<code class="descname"><span class="pre">changed_by_fields</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/mapper.html#Mapper.changed_by_fields"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.mapper.Mapper.changed_by_fields" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a set of fields used by the mapper</p>
<p>It takes in account the <code class="docutils literal notranslate"><span class="pre">direct</span></code> fields and the fields used by
the decorator: <code class="docutils literal notranslate"><span class="pre">changed_by</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="connector.components.mapper.Mapper.map_record">
<code class="descname"><span class="pre">map_record</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">record</span></span></em>, <em><span class="n"><span class="pre">parent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/mapper.html#Mapper.map_record"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.mapper.Mapper.map_record" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a <a class="reference internal" href="#connector.components.mapper.MapRecord" title="connector.components.mapper.MapRecord"><code class="xref py py-class docutils literal notranslate"><span class="pre">MapRecord</span></code></a> with record, ready to be
converted using the current Mapper.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>record</strong> – record to transform</li>
<li><strong>parent</strong> – optional parent record, for items</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="connector.components.mapper.Mapper.finalize">
<code class="descname"><span class="pre">finalize</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">map_record</span></span></em>, <em><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/mapper.html#Mapper.finalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.mapper.Mapper.finalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Called at the end of the mapping.</p>
<p>Can be used to modify the values generated by all the mappings before
returning them.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>map_record</strong> (<a class="reference internal" href="#connector.components.mapper.MapRecord" title="connector.components.mapper.MapRecord"><code class="xref py py-class docutils literal notranslate"><span class="pre">MapRecord</span></code></a>) – source map_record</li>
<li><strong>values</strong> – mapped values</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">mapped values</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="connector.components.mapper.ImportMapper">
<em class="property"><span class="pre">class</span> </em><code class="descclassname"><span class="pre">connector.components.mapper.</span></code><code class="descname"><span class="pre">ImportMapper</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">work_context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/mapper.html#ImportMapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.mapper.ImportMapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#odoo.addons.component.core.AbstractComponent" title="odoo.addons.component.core.AbstractComponent"><code class="xref py py-class docutils literal notranslate"><span class="pre">odoo.addons.component.core.AbstractComponent</span></code></a></p>
<p><a class="reference internal" href="#connector.components.mapper.Mapper" title="connector.components.mapper.Mapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapper</span></code></a> for imports.</p>
<p>Transform a record from a backend to an Odoo record</p>
<dl class="py attribute">
<dt id="connector.components.mapper.ImportMapper._name">
<code class="descname"><span class="pre">_name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'base.import.mapper'</span></em><a class="headerlink" href="#connector.components.mapper.ImportMapper._name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the component</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.mapper.ImportMapper._inherit">
<code class="descname"><span class="pre">_inherit</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'base.mapper'</span></em><a class="headerlink" href="#connector.components.mapper.ImportMapper._inherit" title="Permalink to this definition">¶</a></dt>
<dd><p>Name or list of names of the component(s) to inherit from</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.mapper.ImportMapper._usage">
<code class="descname"><span class="pre">_usage</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'import.mapper'</span></em><a class="headerlink" href="#connector.components.mapper.ImportMapper._usage" title="Permalink to this definition">¶</a></dt>
<dd><p>Component purpose (‘import.mapper’, …).</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="connector.components.mapper.ExportMapper">
<em class="property"><span class="pre">class</span> </em><code class="descclassname"><span class="pre">connector.components.mapper.</span></code><code class="descname"><span class="pre">ExportMapper</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">work_context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/mapper.html#ExportMapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.mapper.ExportMapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#odoo.addons.component.core.AbstractComponent" title="odoo.addons.component.core.AbstractComponent"><code class="xref py py-class docutils literal notranslate"><span class="pre">odoo.addons.component.core.AbstractComponent</span></code></a></p>
<p><a class="reference internal" href="#connector.components.mapper.Mapper" title="connector.components.mapper.Mapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapper</span></code></a> for exports.</p>
<p>Transform a record from Odoo to a backend record</p>
<dl class="py attribute">
<dt id="connector.components.mapper.ExportMapper._name">
<code class="descname"><span class="pre">_name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'base.export.mapper'</span></em><a class="headerlink" href="#connector.components.mapper.ExportMapper._name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the component</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.mapper.ExportMapper._inherit">
<code class="descname"><span class="pre">_inherit</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'base.mapper'</span></em><a class="headerlink" href="#connector.components.mapper.ExportMapper._inherit" title="Permalink to this definition">¶</a></dt>
<dd><p>Name or list of names of the component(s) to inherit from</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.mapper.ExportMapper._usage">
<code class="descname"><span class="pre">_usage</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'export.mapper'</span></em><a class="headerlink" href="#connector.components.mapper.ExportMapper._usage" title="Permalink to this definition">¶</a></dt>
<dd><p>Component purpose (‘import.mapper’, …).</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="connector.components.mapper.MapChild">
<em class="property"><span class="pre">class</span> </em><code class="descclassname"><span class="pre">connector.components.mapper.</span></code><code class="descname"><span class="pre">MapChild</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">work_context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/mapper.html#MapChild"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.mapper.MapChild" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#odoo.addons.component.core.AbstractComponent" title="odoo.addons.component.core.AbstractComponent"><code class="xref py py-class docutils literal notranslate"><span class="pre">odoo.addons.component.core.AbstractComponent</span></code></a></p>
<p>MapChild is responsible to convert items.</p>
<p>Items are sub-records of a main record.
In this example, the items are the records in <code class="docutils literal notranslate"><span class="pre">lines</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sales</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;SO10&#39;</span><span class="p">,</span>
         <span class="s1">&#39;lines&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;product_id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;quantity&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
                   <span class="p">{</span><span class="s1">&#39;product_id&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;quantity&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}]}</span>
</pre></div>
</div>
<p>A MapChild is always called from another <a class="reference internal" href="#connector.components.mapper.Mapper" title="connector.components.mapper.Mapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapper</span></code></a> which
provides a <code class="docutils literal notranslate"><span class="pre">children</span></code> configuration.</p>
<p>Considering the example above, the “main” <a class="reference internal" href="#connector.components.mapper.Mapper" title="connector.components.mapper.Mapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapper</span></code></a> would
returns something as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;SO10&#39;</span><span class="p">,</span>
         <span class="s1">&#39;lines&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;product_id&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;quantity&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}),</span>
                   <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;product_id&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;quantity&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})]}</span>
</pre></div>
</div>
<p>A MapChild is responsible to:</p>
<ul class="simple">
<li>Find the <a class="reference internal" href="#connector.components.mapper.Mapper" title="connector.components.mapper.Mapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapper</span></code></a> to convert the items</li>
<li>Possibly filter out some lines (can be done by inheriting
<a class="reference internal" href="#connector.components.mapper.MapChild.skip_item" title="connector.components.mapper.MapChild.skip_item"><code class="xref py py-meth docutils literal notranslate"><span class="pre">skip_item()</span></code></a>)</li>
<li>Convert the items’ records using the found <a class="reference internal" href="#connector.components.mapper.Mapper" title="connector.components.mapper.Mapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapper</span></code></a></li>
<li>Format the output values to the format expected by Odoo or the
backend (as seen above with <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">0,</span> <span class="pre">{values})</span></code></li>
</ul>
<p>A MapChild can be extended like any other
<code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code>.
However, it is not mandatory to explicitly create a MapChild for
each children mapping, the default one will be used
(<a class="reference internal" href="#connector.components.mapper.ImportMapChild" title="connector.components.mapper.ImportMapChild"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImportMapChild</span></code></a> or <a class="reference internal" href="#connector.components.mapper.ExportMapChild" title="connector.components.mapper.ExportMapChild"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExportMapChild</span></code></a>).</p>
<p>The implementation by default does not take care of the updates: if
I import a sales order 2 times, the lines will be duplicated. This
is not a problem as long as an importation should only support the
creation (typical for sales orders). It can be implemented on a
case-by-case basis by inheriting <a class="reference internal" href="#connector.components.mapper.MapChild.get_item_values" title="connector.components.mapper.MapChild.get_item_values"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_item_values()</span></code></a> and
<a class="reference internal" href="#connector.components.mapper.MapChild.format_items" title="connector.components.mapper.MapChild.format_items"><code class="xref py py-meth docutils literal notranslate"><span class="pre">format_items()</span></code></a>.</p>
<dl class="py attribute">
<dt id="connector.components.mapper.MapChild._name">
<code class="descname"><span class="pre">_name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'base.map.child'</span></em><a class="headerlink" href="#connector.components.mapper.MapChild._name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the component</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.mapper.MapChild._inherit">
<code class="descname"><span class="pre">_inherit</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'base.connector'</span></em><a class="headerlink" href="#connector.components.mapper.MapChild._inherit" title="Permalink to this definition">¶</a></dt>
<dd><p>Name or list of names of the component(s) to inherit from</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.mapper.MapChild._usage">
<code class="descname"><span class="pre">_usage</span></code><em class="property"> <span class="pre">=</span> <span class="pre">None</span></em><a class="headerlink" href="#connector.components.mapper.MapChild._usage" title="Permalink to this definition">¶</a></dt>
<dd><p>Component purpose (‘import.mapper’, …).</p>
</dd></dl>

<dl class="py method">
<dt id="connector.components.mapper.MapChild.skip_item">
<code class="descname"><span class="pre">skip_item</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">map_record</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/mapper.html#MapChild.skip_item"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.mapper.MapChild.skip_item" title="Permalink to this definition">¶</a></dt>
<dd><p>Hook to implement in sub-classes when some child
records should be skipped.</p>
<p>The parent record is accessible in <code class="docutils literal notranslate"><span class="pre">map_record</span></code>.
If it returns True, the current child record is skipped.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>map_record</strong> (<a class="reference internal" href="#connector.components.mapper.MapRecord" title="connector.components.mapper.MapRecord"><code class="xref py py-class docutils literal notranslate"><span class="pre">MapRecord</span></code></a>) – record that we are converting</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="connector.components.mapper.MapChild.get_items">
<code class="descname"><span class="pre">get_items</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">items</span></span></em>, <em><span class="n"><span class="pre">parent</span></span></em>, <em><span class="n"><span class="pre">to_attr</span></span></em>, <em><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/mapper.html#MapChild.get_items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.mapper.MapChild.get_items" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the formatted output values of items from a main record</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>items</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – list of item records</li>
<li><strong>parent</strong> – parent record</li>
<li><strong>to_attr</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – destination field (can be used for introspecting
the relation)</li>
<li><strong>options</strong> – dict of options, herited from the main mapper</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">formatted output values for the item</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="connector.components.mapper.MapChild.get_item_values">
<code class="descname"><span class="pre">get_item_values</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">map_record</span></span></em>, <em><span class="n"><span class="pre">to_attr</span></span></em>, <em><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/mapper.html#MapChild.get_item_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.mapper.MapChild.get_item_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the raw values from the child Mappers for the items.</p>
<p>It can be overridden for instance to:</p>
<ul class="simple">
<li>Change options</li>
<li>Use a <code class="xref py py-class docutils literal notranslate"><span class="pre">Binder</span></code> to know if an
item already exists to modify an existing item, rather than to
add it</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>map_record</strong> (<a class="reference internal" href="#connector.components.mapper.MapRecord" title="connector.components.mapper.MapRecord"><code class="xref py py-class docutils literal notranslate"><span class="pre">MapRecord</span></code></a>) – record that we are converting</li>
<li><strong>to_attr</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – destination field (can be used for introspecting
the relation)</li>
<li><strong>options</strong> – dict of options, herited from the main mapper</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="connector.components.mapper.MapChild.format_items">
<code class="descname"><span class="pre">format_items</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">items_values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/mapper.html#MapChild.format_items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.mapper.MapChild.format_items" title="Permalink to this definition">¶</a></dt>
<dd><p>Format the values of the items mapped from the child Mappers.</p>
<p>It can be overridden for instance to add the Odoo
relationships commands <code class="docutils literal notranslate"><span class="pre">(6,</span> <span class="pre">0,</span> <span class="pre">[IDs])</span></code>, …</p>
<p>As instance, it can be modified to handle update of existing
items: check if an ‘id’ has been defined by
<a class="reference internal" href="#connector.components.mapper.MapChild.get_item_values" title="connector.components.mapper.MapChild.get_item_values"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_item_values()</span></code></a> then use the <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">ID,</span> <span class="pre">{values}</span></code>)
command</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>items_values</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – mapped values for the items</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="connector.components.mapper.ImportMapChild">
<em class="property"><span class="pre">class</span> </em><code class="descclassname"><span class="pre">connector.components.mapper.</span></code><code class="descname"><span class="pre">ImportMapChild</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">work_context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/mapper.html#ImportMapChild"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.mapper.ImportMapChild" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#odoo.addons.component.core.AbstractComponent" title="odoo.addons.component.core.AbstractComponent"><code class="xref py py-class docutils literal notranslate"><span class="pre">odoo.addons.component.core.AbstractComponent</span></code></a></p>
<p><a class="reference internal" href="#connector.components.mapper.MapChild" title="connector.components.mapper.MapChild"><code class="xref py py-class docutils literal notranslate"><span class="pre">MapChild</span></code></a> for the Imports</p>
<dl class="py attribute">
<dt id="connector.components.mapper.ImportMapChild._name">
<code class="descname"><span class="pre">_name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'base.map.child.import'</span></em><a class="headerlink" href="#connector.components.mapper.ImportMapChild._name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the component</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.mapper.ImportMapChild._inherit">
<code class="descname"><span class="pre">_inherit</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'base.map.child'</span></em><a class="headerlink" href="#connector.components.mapper.ImportMapChild._inherit" title="Permalink to this definition">¶</a></dt>
<dd><p>Name or list of names of the component(s) to inherit from</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.mapper.ImportMapChild._usage">
<code class="descname"><span class="pre">_usage</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'import.map.child'</span></em><a class="headerlink" href="#connector.components.mapper.ImportMapChild._usage" title="Permalink to this definition">¶</a></dt>
<dd><p>Component purpose (‘import.mapper’, …).</p>
</dd></dl>

<dl class="py method">
<dt id="connector.components.mapper.ImportMapChild.format_items">
<code class="descname"><span class="pre">format_items</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">items_values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/mapper.html#ImportMapChild.format_items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.mapper.ImportMapChild.format_items" title="Permalink to this definition">¶</a></dt>
<dd><p>Format the values of the items mapped from the child Mappers.</p>
<p>It can be overridden for instance to add the Odoo
relationships commands <code class="docutils literal notranslate"><span class="pre">(6,</span> <span class="pre">0,</span> <span class="pre">[IDs])</span></code>, …</p>
<p>As instance, it can be modified to handle update of existing
items: check if an ‘id’ has been defined by
<code class="xref py py-meth docutils literal notranslate"><span class="pre">get_item_values()</span></code> then use the <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">ID,</span> <span class="pre">{values}</span></code>)
command</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>items_values</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – list of values for the items to create</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="connector.components.mapper.ExportMapChild">
<em class="property"><span class="pre">class</span> </em><code class="descclassname"><span class="pre">connector.components.mapper.</span></code><code class="descname"><span class="pre">ExportMapChild</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">work_context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/mapper.html#ExportMapChild"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.mapper.ExportMapChild" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#odoo.addons.component.core.AbstractComponent" title="odoo.addons.component.core.AbstractComponent"><code class="xref py py-class docutils literal notranslate"><span class="pre">odoo.addons.component.core.AbstractComponent</span></code></a></p>
<p><a class="reference internal" href="#connector.components.mapper.MapChild" title="connector.components.mapper.MapChild"><code class="xref py py-class docutils literal notranslate"><span class="pre">MapChild</span></code></a> for the Exports</p>
<dl class="py attribute">
<dt id="connector.components.mapper.ExportMapChild._name">
<code class="descname"><span class="pre">_name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'base.map.child.export'</span></em><a class="headerlink" href="#connector.components.mapper.ExportMapChild._name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the component</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.mapper.ExportMapChild._inherit">
<code class="descname"><span class="pre">_inherit</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'base.map.child'</span></em><a class="headerlink" href="#connector.components.mapper.ExportMapChild._inherit" title="Permalink to this definition">¶</a></dt>
<dd><p>Name or list of names of the component(s) to inherit from</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.mapper.ExportMapChild._usage">
<code class="descname"><span class="pre">_usage</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'export.map.child'</span></em><a class="headerlink" href="#connector.components.mapper.ExportMapChild._usage" title="Permalink to this definition">¶</a></dt>
<dd><p>Component purpose (‘import.mapper’, …).</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="connector.components.mapper.MapRecord">
<em class="property"><span class="pre">class</span> </em><code class="descclassname"><span class="pre">connector.components.mapper.</span></code><code class="descname"><span class="pre">MapRecord</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">mapper</span></span></em>, <em><span class="n"><span class="pre">source</span></span></em>, <em><span class="n"><span class="pre">parent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/mapper.html#MapRecord"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.mapper.MapRecord" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A record prepared to be converted using a <a class="reference internal" href="#connector.components.mapper.Mapper" title="connector.components.mapper.Mapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapper</span></code></a>.</p>
<p>MapRecord instances are prepared by <a class="reference internal" href="#connector.components.mapper.Mapper.map_record" title="connector.components.mapper.Mapper.map_record"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Mapper.map_record()</span></code></a>.</p>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">map_record</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="n">map_record</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_values</span> <span class="o">=</span> <span class="n">map_record</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="#connector.components.mapper.MapRecord.values" title="connector.components.mapper.MapRecord.values"><code class="xref py py-meth docutils literal notranslate"><span class="pre">values()</span></code></a> for more information on the available arguments.</p>
<dl class="py method">
<dt id="connector.components.mapper.MapRecord.update">
<code class="descname"><span class="pre">update</span></code><span class="sig-paren">(</span><em><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/mapper.html#MapRecord.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.mapper.MapRecord.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Force values to be applied after a mapping.</p>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">map_record</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="n">map_record</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">map_record</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_values</span> <span class="o">=</span> <span class="n">map_record</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go"># output_values will at least contain {&#39;a&#39;: 1}</span>
</pre></div>
</div>
<p>The values assigned with <code class="docutils literal notranslate"><span class="pre">update()</span></code> are in any case applied,
they have a greater priority than the mapping values.</p>
</dd></dl>

<dl class="py method">
<dt id="connector.components.mapper.MapRecord.values">
<code class="descname"><span class="pre">values</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">for_create</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em><span class="n"><span class="pre">fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/mapper.html#MapRecord.values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.mapper.MapRecord.values" title="Permalink to this definition">¶</a></dt>
<dd><p>Build and returns the mapped values according to the options.</p>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">map_record</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="n">map_record</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_values</span> <span class="o">=</span> <span class="n">map_record</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Creation of records</dt><dd><p>When using the option <code class="docutils literal notranslate"><span class="pre">for_create</span></code>, only the mappings decorated
with <code class="docutils literal notranslate"><span class="pre">&#64;only_create</span></code> will be mapped.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">output_values</span> <span class="o">=</span> <span class="n">map_record</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">for_create</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Filter on fields</dt><dd><p>When using the <code class="docutils literal notranslate"><span class="pre">fields</span></code> argument, the mappings will be
filtered using either the source key in <code class="docutils literal notranslate"><span class="pre">direct</span></code> arguments,
either the <code class="docutils literal notranslate"><span class="pre">changed_by</span></code> arguments for the mapping methods.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">output_values</span> <span class="o">=</span> <span class="n">map_record</span><span class="o">.</span><span class="n">values</span><span class="p">(</span>
<span class="go">        fields=[&#39;name&#39;, &#39;street&#39;]</span>
<span class="go">    )</span>
</pre></div>
</div>
</dd>
<dt>Custom options</dt><dd><p>Arbitrary key and values can be defined in the <code class="docutils literal notranslate"><span class="pre">kwargs</span></code>
arguments.  They can later be used in the mapping methods
using <code class="docutils literal notranslate"><span class="pre">self.options</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">output_values</span> <span class="o">=</span> <span class="n">map_record</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">tax_include</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>for_create</strong> (<em>boolean</em>) – specify if only the mappings for creation
(<code class="docutils literal notranslate"><span class="pre">&#64;only_create</span></code>) should be mapped.</li>
<li><strong>fields</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – filter on fields</li>
<li><strong>**kwargs</strong> – custom options, they can later be used in the
mapping methods</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="connector.components.mapper.MapRecord.parent">
<em class="property"><span class="pre">property</span> </em><code class="descname"><span class="pre">parent</span></code><a class="headerlink" href="#connector.components.mapper.MapRecord.parent" title="Permalink to this definition">¶</a></dt>
<dd><p>Parent record if the current record is an item</p>
</dd></dl>

<dl class="py method">
<dt id="connector.components.mapper.MapRecord.source">
<em class="property"><span class="pre">property</span> </em><code class="descname"><span class="pre">source</span></code><a class="headerlink" href="#connector.components.mapper.MapRecord.source" title="Permalink to this definition">¶</a></dt>
<dd><p>Source record to be converted</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="connector.components.mapper.changed_by">
<code class="descclassname"><span class="pre">connector.components.mapper.</span></code><code class="descname"><span class="pre">changed_by</span></code><span class="sig-paren">(</span><em><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/mapper.html#changed_by"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.mapper.changed_by" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator for the mapping methods (<a class="reference internal" href="#connector.components.mapper.mapping" title="connector.components.mapper.mapping"><code class="xref py py-func docutils literal notranslate"><span class="pre">mapping()</span></code></a>)</p>
<p>When fields are modified in Odoo, we want to export only the
modified fields. Using this decorator, we can specify which fields
updates should trigger which mapping method.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">changed_by</span></code> is empty, the mapping is always active.</p>
<p>As far as possible, this decorator should be used for the exports,
thus, when we do an update on only a small number of fields on a
record, the size of the output record will be limited to only the
fields really having to be exported.</p>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@changed_by</span><span class="p">(</span><span class="s1">&#39;input_field&#39;</span><span class="p">)</span>
<span class="nd">@mapping</span>
<span class="k">def</span> <span class="nf">any</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;output_field&#39;</span><span class="p">:</span> <span class="n">record</span><span class="p">[</span><span class="s1">&#39;input_field&#39;</span><span class="p">]}</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>*args</strong> – field names which trigger the mapping when modified</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py function">
<dt id="connector.components.mapper.convert">
<code class="descclassname"><span class="pre">connector.components.mapper.</span></code><code class="descname"><span class="pre">convert</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">field</span></span></em>, <em><span class="n"><span class="pre">conv_type</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/mapper.html#convert"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.mapper.convert" title="Permalink to this definition">¶</a></dt>
<dd><p>A modifier intended to be used on the <code class="docutils literal notranslate"><span class="pre">direct</span></code> mappings.</p>
<p>Convert a field’s value to a given type.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">direct</span> <span class="o">=</span> <span class="p">[(</span><span class="n">convert</span><span class="p">(</span><span class="s1">&#39;source&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="s1">&#39;target&#39;</span><span class="p">)]</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>field</strong> – name of the source field in the record</li>
<li><strong>binding</strong> – True if the relation is a binding record</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py function">
<dt id="connector.components.mapper.external_to_m2o">
<code class="descclassname"><span class="pre">connector.components.mapper.</span></code><code class="descname"><span class="pre">external_to_m2o</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">field</span></span></em>, <em><span class="n"><span class="pre">binding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/mapper.html#external_to_m2o"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.mapper.external_to_m2o" title="Permalink to this definition">¶</a></dt>
<dd><p>A modifier intended to be used on the <code class="docutils literal notranslate"><span class="pre">direct</span></code> mappings.</p>
<p>For a field from a backend which is an ID, search the corresponding
binding in Odoo and returns it.</p>
<p>When the field’s relation is not a binding (i.e. it does not point to
something like <code class="docutils literal notranslate"><span class="pre">magento.*</span></code>), the binding model needs to be provided
in the <code class="docutils literal notranslate"><span class="pre">binding</span></code> keyword argument.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">direct</span> <span class="o">=</span> <span class="p">[(</span><span class="n">external_to_m2o</span><span class="p">(</span><span class="s1">&#39;country&#39;</span><span class="p">,</span> <span class="n">binding</span><span class="o">=</span><span class="s1">&#39;magento.res.country&#39;</span><span class="p">),</span>
           <span class="s1">&#39;country_id&#39;</span><span class="p">),</span>
          <span class="p">(</span><span class="n">external_to_m2o</span><span class="p">(</span><span class="s1">&#39;country&#39;</span><span class="p">),</span> <span class="s1">&#39;magento_country_id&#39;</span><span class="p">)]</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>field</strong> – name of the source field in the record</li>
<li><strong>binding</strong> – name of the binding model is the relation is not a binding</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py function">
<dt id="connector.components.mapper.follow_m2o_relations">
<code class="descclassname"><span class="pre">connector.components.mapper.</span></code><code class="descname"><span class="pre">follow_m2o_relations</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/mapper.html#follow_m2o_relations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.mapper.follow_m2o_relations" title="Permalink to this definition">¶</a></dt>
<dd><p>A modifier intended to be used on <code class="docutils literal notranslate"><span class="pre">direct</span></code> mappings.</p>
<p>‘Follows’ Many2one relations and return the final field value.</p>
<dl class="docutils">
<dt>Examples:</dt><dd><p>Assuming model is <code class="docutils literal notranslate"><span class="pre">product.product</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">direct</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="n">follow_m2o_relations</span><span class="p">(</span><span class="s1">&#39;product_tmpl_id.categ_id.name&#39;</span><span class="p">),</span> <span class="s1">&#39;cat&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>field</strong> – field “path”, using dots for relations as usual in Odoo</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py function">
<dt id="connector.components.mapper.m2o_to_external">
<code class="descclassname"><span class="pre">connector.components.mapper.</span></code><code class="descname"><span class="pre">m2o_to_external</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">field</span></span></em>, <em><span class="n"><span class="pre">binding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/mapper.html#m2o_to_external"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.mapper.m2o_to_external" title="Permalink to this definition">¶</a></dt>
<dd><p>A modifier intended to be used on the <code class="docutils literal notranslate"><span class="pre">direct</span></code> mappings.</p>
<p>For a many2one, get the external ID and returns it.</p>
<p>When the field’s relation is not a binding (i.e. it does not point to
something like <code class="docutils literal notranslate"><span class="pre">magento.*</span></code>), the binding model needs to be provided
in the <code class="docutils literal notranslate"><span class="pre">binding</span></code> keyword argument.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">direct</span> <span class="o">=</span> <span class="p">[(</span><span class="n">m2o_to_external</span><span class="p">(</span><span class="s1">&#39;country_id&#39;</span><span class="p">,</span>
                           <span class="n">binding</span><span class="o">=</span><span class="s1">&#39;magento.res.country&#39;</span><span class="p">),</span> <span class="s1">&#39;country&#39;</span><span class="p">),</span>
          <span class="p">(</span><span class="n">m2o_to_external</span><span class="p">(</span><span class="s1">&#39;magento_country_id&#39;</span><span class="p">),</span> <span class="s1">&#39;country&#39;</span><span class="p">)]</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>field</strong> – name of the source field in the record</li>
<li><strong>binding</strong> – name of the binding model is the relation is not a binding</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py function">
<dt id="connector.components.mapper.mapping">
<code class="descclassname"><span class="pre">connector.components.mapper.</span></code><code class="descname"><span class="pre">mapping</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/mapper.html#mapping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.mapper.mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator, declare that a method is a mapping method.</p>
<p>It is then used by the <a class="reference internal" href="#connector.components.mapper.Mapper" title="connector.components.mapper.Mapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapper</span></code></a> to convert the records.</p>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@mapping</span>
<span class="k">def</span> <span class="nf">any</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;output_field&#39;</span><span class="p">:</span> <span class="n">record</span><span class="p">[</span><span class="s1">&#39;input_field&#39;</span><span class="p">]}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="connector.components.mapper.none">
<code class="descclassname"><span class="pre">connector.components.mapper.</span></code><code class="descname"><span class="pre">none</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/mapper.html#none"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.mapper.none" title="Permalink to this definition">¶</a></dt>
<dd><p>A modifier intended to be used on the <code class="docutils literal notranslate"><span class="pre">direct</span></code> mappings.</p>
<p>Replace the False-ish values by None.
It can be used in a pipeline of modifiers when .</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">direct</span> <span class="o">=</span> <span class="p">[(</span><span class="n">none</span><span class="p">(</span><span class="s1">&#39;source&#39;</span><span class="p">),</span> <span class="s1">&#39;target&#39;</span><span class="p">),</span>
          <span class="p">(</span><span class="n">none</span><span class="p">(</span><span class="n">m2o_to_external</span><span class="p">(</span><span class="s1">&#39;rel_id&#39;</span><span class="p">),</span> <span class="s1">&#39;rel_id&#39;</span><span class="p">)]</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>field</strong> – name of the source field in the record</li>
<li><strong>binding</strong> – True if the relation is a binding record</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py function">
<dt id="connector.components.mapper.only_create">
<code class="descclassname"><span class="pre">connector.components.mapper.</span></code><code class="descname"><span class="pre">only_create</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/mapper.html#only_create"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.mapper.only_create" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator for the mapping methods (<a class="reference internal" href="#connector.components.mapper.mapping" title="connector.components.mapper.mapping"><code class="xref py py-func docutils literal notranslate"><span class="pre">mapping()</span></code></a>)</p>
<p>A mapping decorated with <code class="docutils literal notranslate"><span class="pre">only_create</span></code> means that it has to be
used only for the creation of the records.</p>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@only_create</span>
<span class="nd">@mapping</span>
<span class="k">def</span> <span class="nf">any</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;output_field&#39;</span><span class="p">:</span> <span class="n">record</span><span class="p">[</span><span class="s1">&#39;input_field&#39;</span><span class="p">]}</span>
</pre></div>
</div>
</dd></dl>

</div>
<span class="target" id="module-connector.components.backend_adapter"></span><div class="section" id="backend-adapter">
<h3>Backend Adapter<a class="headerlink" href="#backend-adapter" title="Permalink to this headline">¶</a></h3>
<p>An external adapter has a common interface to speak with the backend.
It translates the basic orders (search, read, write) to the protocol
used by the backend.</p>
<dl class="py class">
<dt id="connector.components.backend_adapter.BackendAdapter">
<em class="property"><span class="pre">class</span> </em><code class="descclassname"><span class="pre">connector.components.backend_adapter.</span></code><code class="descname"><span class="pre">BackendAdapter</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">work_context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/backend_adapter.html#BackendAdapter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.backend_adapter.BackendAdapter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#odoo.addons.component.core.AbstractComponent" title="odoo.addons.component.core.AbstractComponent"><code class="xref py py-class docutils literal notranslate"><span class="pre">odoo.addons.component.core.AbstractComponent</span></code></a></p>
<p>Base Backend Adapter for the connectors</p>
<dl class="py attribute">
<dt id="connector.components.backend_adapter.BackendAdapter._name">
<code class="descname"><span class="pre">_name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'base.backend.adapter'</span></em><a class="headerlink" href="#connector.components.backend_adapter.BackendAdapter._name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the component</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.backend_adapter.BackendAdapter._inherit">
<code class="descname"><span class="pre">_inherit</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'base.connector'</span></em><a class="headerlink" href="#connector.components.backend_adapter.BackendAdapter._inherit" title="Permalink to this definition">¶</a></dt>
<dd><p>Name or list of names of the component(s) to inherit from</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.backend_adapter.BackendAdapter._usage">
<code class="descname"><span class="pre">_usage</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'backend.adapter'</span></em><a class="headerlink" href="#connector.components.backend_adapter.BackendAdapter._usage" title="Permalink to this definition">¶</a></dt>
<dd><p>Component purpose (‘import.mapper’, …).</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="connector.components.backend_adapter.CRUDAdapter">
<em class="property"><span class="pre">class</span> </em><code class="descclassname"><span class="pre">connector.components.backend_adapter.</span></code><code class="descname"><span class="pre">CRUDAdapter</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">work_context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/backend_adapter.html#CRUDAdapter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.backend_adapter.CRUDAdapter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#odoo.addons.component.core.AbstractComponent" title="odoo.addons.component.core.AbstractComponent"><code class="xref py py-class docutils literal notranslate"><span class="pre">odoo.addons.component.core.AbstractComponent</span></code></a></p>
<p>Base External Adapter specialized in the handling
of records on external systems.</p>
<p>This is an empty shell, Components can inherit and implement their own
implementation for the methods.</p>
<dl class="py attribute">
<dt id="connector.components.backend_adapter.CRUDAdapter._name">
<code class="descname"><span class="pre">_name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'base.backend.adapter.crud'</span></em><a class="headerlink" href="#connector.components.backend_adapter.CRUDAdapter._name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the component</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.backend_adapter.CRUDAdapter._inherit">
<code class="descname"><span class="pre">_inherit</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'base.backend.adapter'</span></em><a class="headerlink" href="#connector.components.backend_adapter.CRUDAdapter._inherit" title="Permalink to this definition">¶</a></dt>
<dd><p>Name or list of names of the component(s) to inherit from</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.backend_adapter.CRUDAdapter._usage">
<code class="descname"><span class="pre">_usage</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'backend.adapter'</span></em><a class="headerlink" href="#connector.components.backend_adapter.CRUDAdapter._usage" title="Permalink to this definition">¶</a></dt>
<dd><p>Component purpose (‘import.mapper’, …).</p>
</dd></dl>

<dl class="py method">
<dt id="connector.components.backend_adapter.CRUDAdapter.search">
<code class="descname"><span class="pre">search</span></code><span class="sig-paren">(</span><em><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/backend_adapter.html#CRUDAdapter.search"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.backend_adapter.CRUDAdapter.search" title="Permalink to this definition">¶</a></dt>
<dd><p>Search records according to some criterias
and returns a list of ids</p>
</dd></dl>

<dl class="py method">
<dt id="connector.components.backend_adapter.CRUDAdapter.read">
<code class="descname"><span class="pre">read</span></code><span class="sig-paren">(</span><em><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/backend_adapter.html#CRUDAdapter.read"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.backend_adapter.CRUDAdapter.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the information of a record</p>
</dd></dl>

<dl class="py method">
<dt id="connector.components.backend_adapter.CRUDAdapter.search_read">
<code class="descname"><span class="pre">search_read</span></code><span class="sig-paren">(</span><em><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/backend_adapter.html#CRUDAdapter.search_read"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.backend_adapter.CRUDAdapter.search_read" title="Permalink to this definition">¶</a></dt>
<dd><p>Search records according to some criterias
and returns their information</p>
</dd></dl>

<dl class="py method">
<dt id="connector.components.backend_adapter.CRUDAdapter.create">
<code class="descname"><span class="pre">create</span></code><span class="sig-paren">(</span><em><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/backend_adapter.html#CRUDAdapter.create"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.backend_adapter.CRUDAdapter.create" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a record on the external system</p>
</dd></dl>

<dl class="py method">
<dt id="connector.components.backend_adapter.CRUDAdapter.write">
<code class="descname"><span class="pre">write</span></code><span class="sig-paren">(</span><em><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/backend_adapter.html#CRUDAdapter.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.backend_adapter.CRUDAdapter.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Update records on the external system</p>
</dd></dl>

<dl class="py method">
<dt id="connector.components.backend_adapter.CRUDAdapter.delete">
<code class="descname"><span class="pre">delete</span></code><span class="sig-paren">(</span><em><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/backend_adapter.html#CRUDAdapter.delete"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.backend_adapter.CRUDAdapter.delete" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete a record on the external system</p>
</dd></dl>

</dd></dl>

</div>
<span class="target" id="module-connector.components.synchronizer"></span><div class="section" id="synchronizer">
<h3>Synchronizer<a class="headerlink" href="#synchronizer" title="Permalink to this headline">¶</a></h3>
<p>A synchronizer orchestrates a synchronization with a backend. It’s the actor
who runs the flow and glues the logic of an import or export (or else).
It uses other components for specialized tasks.</p>
<p>For instance, it will use the mappings to convert the data between both
systems, the backend adapters to read or write data on the backend and the
binders to create the link between them.</p>
<dl class="py class">
<dt id="connector.components.synchronizer.Synchronizer">
<em class="property"><span class="pre">class</span> </em><code class="descclassname"><span class="pre">connector.components.synchronizer.</span></code><code class="descname"><span class="pre">Synchronizer</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">work_context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/synchronizer.html#Synchronizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.synchronizer.Synchronizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#odoo.addons.component.core.AbstractComponent" title="odoo.addons.component.core.AbstractComponent"><code class="xref py py-class docutils literal notranslate"><span class="pre">odoo.addons.component.core.AbstractComponent</span></code></a></p>
<p>Base class for synchronizers</p>
<dl class="py attribute">
<dt id="connector.components.synchronizer.Synchronizer._name">
<code class="descname"><span class="pre">_name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'base.synchronizer'</span></em><a class="headerlink" href="#connector.components.synchronizer.Synchronizer._name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the component</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.synchronizer.Synchronizer._inherit">
<code class="descname"><span class="pre">_inherit</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'base.connector'</span></em><a class="headerlink" href="#connector.components.synchronizer.Synchronizer._inherit" title="Permalink to this definition">¶</a></dt>
<dd><p>Name or list of names of the component(s) to inherit from</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.synchronizer.Synchronizer._base_mapper_usage">
<code class="descname"><span class="pre">_base_mapper_usage</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'mapper'</span></em><a class="headerlink" href="#connector.components.synchronizer.Synchronizer._base_mapper_usage" title="Permalink to this definition">¶</a></dt>
<dd><p>usage of the component used as mapper, can be customized in sub-classes</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.synchronizer.Synchronizer._base_backend_adapter_usage">
<code class="descname"><span class="pre">_base_backend_adapter_usage</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'backend.adapter'</span></em><a class="headerlink" href="#connector.components.synchronizer.Synchronizer._base_backend_adapter_usage" title="Permalink to this definition">¶</a></dt>
<dd><p>usage of the component used as backend adapter,
can be customized in sub-classes</p>
</dd></dl>

<dl class="py method">
<dt id="connector.components.synchronizer.Synchronizer.run">
<code class="descname"><span class="pre">run</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/synchronizer.html#Synchronizer.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.synchronizer.Synchronizer.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the synchronization</p>
</dd></dl>

<dl class="py method">
<dt id="connector.components.synchronizer.Synchronizer.mapper">
<em class="property"><span class="pre">property</span> </em><code class="descname"><span class="pre">mapper</span></code><a class="headerlink" href="#connector.components.synchronizer.Synchronizer.mapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance of <code class="docutils literal notranslate"><span class="pre">Mapper</span></code> for the synchronization.</p>
<p>The instanciation is delayed because some synchronisations do
not need such an unit and the unit may not exist.</p>
<p>It looks for a Component with <code class="docutils literal notranslate"><span class="pre">_usage</span></code> being equal to
<code class="docutils literal notranslate"><span class="pre">_base_mapper_usage</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#odoo.addons.component.core.Component" title="odoo.addons.component.core.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">odoo.addons.component.core.Component</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="connector.components.synchronizer.Synchronizer.binder">
<em class="property"><span class="pre">property</span> </em><code class="descname"><span class="pre">binder</span></code><a class="headerlink" href="#connector.components.synchronizer.Synchronizer.binder" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance of <code class="docutils literal notranslate"><span class="pre">Binder</span></code> for the synchronization.</p>
<p>The instanciation is delayed because some synchronisations do
not need such an unit and the unit may not exist.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#odoo.addons.component.core.Component" title="odoo.addons.component.core.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">odoo.addons.component.core.Component</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="connector.components.synchronizer.Synchronizer.backend_adapter">
<em class="property"><span class="pre">property</span> </em><code class="descname"><span class="pre">backend_adapter</span></code><a class="headerlink" href="#connector.components.synchronizer.Synchronizer.backend_adapter" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance of <code class="docutils literal notranslate"><span class="pre">BackendAdapter</span></code> for the
synchronization.</p>
<p>The instanciation is delayed because some synchronisations do
not need such an unit and the unit may not exist.</p>
<p>It looks for a Component with <code class="docutils literal notranslate"><span class="pre">_usage</span></code> being equal to
<code class="docutils literal notranslate"><span class="pre">_base_backend_adapter_usage</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#odoo.addons.component.core.Component" title="odoo.addons.component.core.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">odoo.addons.component.core.Component</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="connector.components.synchronizer.Exporter">
<em class="property"><span class="pre">class</span> </em><code class="descclassname"><span class="pre">connector.components.synchronizer.</span></code><code class="descname"><span class="pre">Exporter</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">work_context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/synchronizer.html#Exporter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.synchronizer.Exporter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#odoo.addons.component.core.AbstractComponent" title="odoo.addons.component.core.AbstractComponent"><code class="xref py py-class docutils literal notranslate"><span class="pre">odoo.addons.component.core.AbstractComponent</span></code></a></p>
<p>Synchronizer for exporting data from Odoo to a backend</p>
<dl class="py attribute">
<dt id="connector.components.synchronizer.Exporter._name">
<code class="descname"><span class="pre">_name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'base.exporter'</span></em><a class="headerlink" href="#connector.components.synchronizer.Exporter._name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the component</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.synchronizer.Exporter._inherit">
<code class="descname"><span class="pre">_inherit</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'base.synchronizer'</span></em><a class="headerlink" href="#connector.components.synchronizer.Exporter._inherit" title="Permalink to this definition">¶</a></dt>
<dd><p>Name or list of names of the component(s) to inherit from</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.synchronizer.Exporter._usage">
<code class="descname"><span class="pre">_usage</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'exporter'</span></em><a class="headerlink" href="#connector.components.synchronizer.Exporter._usage" title="Permalink to this definition">¶</a></dt>
<dd><p>Component purpose (‘import.mapper’, …).</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.synchronizer.Exporter._base_mapper_usage">
<code class="descname"><span class="pre">_base_mapper_usage</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'export.mapper'</span></em><a class="headerlink" href="#connector.components.synchronizer.Exporter._base_mapper_usage" title="Permalink to this definition">¶</a></dt>
<dd><p>usage of the component used as mapper, can be customized in sub-classes</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="connector.components.synchronizer.GenericExporter">
<em class="property"><span class="pre">class</span> </em><code class="descclassname"><span class="pre">connector.components.synchronizer.</span></code><code class="descname"><span class="pre">GenericExporter</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">working_context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/synchronizer.html#GenericExporter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.synchronizer.GenericExporter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#odoo.addons.component.core.AbstractComponent" title="odoo.addons.component.core.AbstractComponent"><code class="xref py py-class docutils literal notranslate"><span class="pre">odoo.addons.component.core.AbstractComponent</span></code></a></p>
<p>Generic Synchronizer for exporting data from Odoo to a backend</p>
<dl class="py attribute">
<dt id="connector.components.synchronizer.GenericExporter._name">
<code class="descname"><span class="pre">_name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'generic.exporter'</span></em><a class="headerlink" href="#connector.components.synchronizer.GenericExporter._name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the component</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.synchronizer.GenericExporter._inherit">
<code class="descname"><span class="pre">_inherit</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'base.exporter'</span></em><a class="headerlink" href="#connector.components.synchronizer.GenericExporter._inherit" title="Permalink to this definition">¶</a></dt>
<dd><p>Name or list of names of the component(s) to inherit from</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.synchronizer.GenericExporter._default_binding_field">
<code class="descname"><span class="pre">_default_binding_field</span></code><em class="property"> <span class="pre">=</span> <span class="pre">None</span></em><a class="headerlink" href="#connector.components.synchronizer.GenericExporter._default_binding_field" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="connector.components.synchronizer.GenericExporter._should_import">
<code class="descname"><span class="pre">_should_import</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/synchronizer.html#GenericExporter._should_import"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.synchronizer.GenericExporter._should_import" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="connector.components.synchronizer.GenericExporter._delay_import">
<code class="descname"><span class="pre">_delay_import</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/synchronizer.html#GenericExporter._delay_import"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.synchronizer.GenericExporter._delay_import" title="Permalink to this definition">¶</a></dt>
<dd><p>Schedule an import of the record.</p>
<p>Adapt in the sub-classes when the model is not imported
using <code class="docutils literal notranslate"><span class="pre">import_record</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="connector.components.synchronizer.GenericExporter.run">
<code class="descname"><span class="pre">run</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">binding</span></span></em>, <em><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/synchronizer.html#GenericExporter.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.synchronizer.GenericExporter.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the synchronization</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>binding</strong> – binding record to export</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="connector.components.synchronizer.GenericExporter._run">
<code class="descname"><span class="pre">_run</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/synchronizer.html#GenericExporter._run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.synchronizer.GenericExporter._run" title="Permalink to this definition">¶</a></dt>
<dd><p>Flow of the synchronization, implemented in inherited classes</p>
</dd></dl>

<dl class="py method">
<dt id="connector.components.synchronizer.GenericExporter._after_export">
<code class="descname"><span class="pre">_after_export</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/synchronizer.html#GenericExporter._after_export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.synchronizer.GenericExporter._after_export" title="Permalink to this definition">¶</a></dt>
<dd><p>Can do several actions after exporting a record on the backend</p>
</dd></dl>

<dl class="py method">
<dt id="connector.components.synchronizer.GenericExporter._lock">
<code class="descname"><span class="pre">_lock</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/synchronizer.html#GenericExporter._lock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.synchronizer.GenericExporter._lock" title="Permalink to this definition">¶</a></dt>
<dd><p>Lock the binding record.</p>
<p>Lock the binding record so we are sure that only one export
job is running for this record if concurrent jobs have to export the
same record.</p>
<p>When concurrent jobs try to export the same record, the first one
will lock and proceed, the others will fail to lock and will be
retried later.</p>
<p>This behavior works also when the export becomes multilevel
with <a class="reference internal" href="#connector.components.synchronizer.GenericExporter._export_dependencies" title="connector.components.synchronizer.GenericExporter._export_dependencies"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_export_dependencies()</span></code></a>. Each level will set its own lock
on the binding record it has to export.</p>
</dd></dl>

<dl class="py method">
<dt id="connector.components.synchronizer.GenericExporter._has_to_skip">
<code class="descname"><span class="pre">_has_to_skip</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/synchronizer.html#GenericExporter._has_to_skip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.synchronizer.GenericExporter._has_to_skip" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if the export can be skipped</p>
</dd></dl>

<dl class="py method">
<dt id="connector.components.synchronizer.GenericExporter._retry_unique_violation">
<code class="descname"><span class="pre">_retry_unique_violation</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/synchronizer.html#GenericExporter._retry_unique_violation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.synchronizer.GenericExporter._retry_unique_violation" title="Permalink to this definition">¶</a></dt>
<dd><p>Context manager: catch Unique constraint error and retry the
job later.</p>
<p>When we execute several jobs workers concurrently, it happens
that 2 jobs are creating the same record at the same time (binding
record created by <a class="reference internal" href="#connector.components.synchronizer.GenericExporter._export_dependency" title="connector.components.synchronizer.GenericExporter._export_dependency"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_export_dependency()</span></code></a>), resulting in:</p>
<blockquote>
<div>IntegrityError: duplicate key value violates unique
constraint “my_backend_product_product_odoo_uniq”
DETAIL:  Key (backend_id, odoo_id)=(1, 4851) already exists.</div></blockquote>
<p>In that case, we’ll retry the import just later.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The unique constraint must be created on the
binding record to prevent 2 bindings to be created
for the same External record.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="connector.components.synchronizer.GenericExporter._export_dependency">
<code class="descname"><span class="pre">_export_dependency</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">relation</span></span></em>, <em><span class="n"><span class="pre">binding_model</span></span></em>, <em><span class="n"><span class="pre">component_usage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'record.exporter'</span></span></em>, <em><span class="n"><span class="pre">binding_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em><span class="n"><span class="pre">binding_extra_vals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/synchronizer.html#GenericExporter._export_dependency"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.synchronizer.GenericExporter._export_dependency" title="Permalink to this definition">¶</a></dt>
<dd><p>Export a dependency. The exporter class is a subclass of
<code class="docutils literal notranslate"><span class="pre">GenericExporter</span></code>. If a more precise class need to be defined,
it can be passed to the <code class="docutils literal notranslate"><span class="pre">exporter_class</span></code> keyword argument.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>a commit is done at the end of the export of each
dependency. The reason for that is that we pushed a record
on the backend and we absolutely have to keep its ID.</p>
<p>So you <em>must</em> take care not to modify the Odoo
database during an export, excepted when writing
back the external ID or eventually to store
external data that we have to keep on this side.</p>
<p class="last">You should call this method only at the beginning
of the exporter synchronization,
in <a class="reference internal" href="#connector.components.synchronizer.GenericExporter._export_dependencies" title="connector.components.synchronizer.GenericExporter._export_dependencies"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_export_dependencies()</span></code></a>.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>relation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">odoo.models.BaseModel</span></code>) – record to export if not already exported</li>
<li><strong>binding_model</strong> (<em>str | unicode</em>) – name of the binding model for the relation</li>
<li><strong>component_usage</strong> – ‘usage’ to look for to find the Component to
for the export, by default ‘record.exporter’</li>
<li><strong>binding_field</strong> (<em>str | unicode</em>) – name of the one2many field on a normal
record that points to the binding record
(default: my_backend_bind_ids).
It is used only when the relation is not
a binding but is a normal record.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Binding_extra_vals:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><p class="first last">In case we want to create a new binding
pass extra values for this binding</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="connector.components.synchronizer.GenericExporter._export_dependencies">
<code class="descname"><span class="pre">_export_dependencies</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/synchronizer.html#GenericExporter._export_dependencies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.synchronizer.GenericExporter._export_dependencies" title="Permalink to this definition">¶</a></dt>
<dd><p>Export the dependencies for the record</p>
</dd></dl>

<dl class="py method">
<dt id="connector.components.synchronizer.GenericExporter._map_data">
<code class="descname"><span class="pre">_map_data</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/synchronizer.html#GenericExporter._map_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.synchronizer.GenericExporter._map_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an instance of
<code class="xref py py-class docutils literal notranslate"><span class="pre">MapRecord</span></code></p>
</dd></dl>

<dl class="py method">
<dt id="connector.components.synchronizer.GenericExporter._validate_create_data">
<code class="descname"><span class="pre">_validate_create_data</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/synchronizer.html#GenericExporter._validate_create_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.synchronizer.GenericExporter._validate_create_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the values to import are correct</p>
<p>Pro-actively check before the <code class="docutils literal notranslate"><span class="pre">Model.create</span></code> if some fields
are missing or invalid</p>
<p>Raise <cite>InvalidDataError</cite></p>
</dd></dl>

<dl class="py method">
<dt id="connector.components.synchronizer.GenericExporter._validate_update_data">
<code class="descname"><span class="pre">_validate_update_data</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/synchronizer.html#GenericExporter._validate_update_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.synchronizer.GenericExporter._validate_update_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the values to import are correct</p>
<p>Pro-actively check before the <code class="docutils literal notranslate"><span class="pre">Model.update</span></code> if some fields
are missing or invalid</p>
<p>Raise <cite>InvalidDataError</cite></p>
</dd></dl>

<dl class="py method">
<dt id="connector.components.synchronizer.GenericExporter._create_data">
<code class="descname"><span class="pre">_create_data</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">map_record</span></span></em>, <em><span class="n"><span class="pre">fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/synchronizer.html#GenericExporter._create_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.synchronizer.GenericExporter._create_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the data to pass to <a class="reference internal" href="#connector.components.synchronizer.GenericExporter._create" title="connector.components.synchronizer.GenericExporter._create"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_create()</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt id="connector.components.synchronizer.GenericExporter._create">
<code class="descname"><span class="pre">_create</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/synchronizer.html#GenericExporter._create"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.synchronizer.GenericExporter._create" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the External record</p>
</dd></dl>

<dl class="py method">
<dt id="connector.components.synchronizer.GenericExporter._update_data">
<code class="descname"><span class="pre">_update_data</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">map_record</span></span></em>, <em><span class="n"><span class="pre">fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/synchronizer.html#GenericExporter._update_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.synchronizer.GenericExporter._update_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the data to pass to <a class="reference internal" href="#connector.components.synchronizer.GenericExporter._update" title="connector.components.synchronizer.GenericExporter._update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_update()</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt id="connector.components.synchronizer.GenericExporter._update">
<code class="descname"><span class="pre">_update</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/synchronizer.html#GenericExporter._update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.synchronizer.GenericExporter._update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update an External record</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="connector.components.synchronizer.Importer">
<em class="property"><span class="pre">class</span> </em><code class="descclassname"><span class="pre">connector.components.synchronizer.</span></code><code class="descname"><span class="pre">Importer</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">work_context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/synchronizer.html#Importer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.synchronizer.Importer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#odoo.addons.component.core.AbstractComponent" title="odoo.addons.component.core.AbstractComponent"><code class="xref py py-class docutils literal notranslate"><span class="pre">odoo.addons.component.core.AbstractComponent</span></code></a></p>
<p>Synchronizer for importing data from a backend to Odoo</p>
<dl class="py attribute">
<dt id="connector.components.synchronizer.Importer._name">
<code class="descname"><span class="pre">_name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'base.importer'</span></em><a class="headerlink" href="#connector.components.synchronizer.Importer._name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the component</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.synchronizer.Importer._inherit">
<code class="descname"><span class="pre">_inherit</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'base.synchronizer'</span></em><a class="headerlink" href="#connector.components.synchronizer.Importer._inherit" title="Permalink to this definition">¶</a></dt>
<dd><p>Name or list of names of the component(s) to inherit from</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.synchronizer.Importer._usage">
<code class="descname"><span class="pre">_usage</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'importer'</span></em><a class="headerlink" href="#connector.components.synchronizer.Importer._usage" title="Permalink to this definition">¶</a></dt>
<dd><p>Component purpose (‘import.mapper’, …).</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.synchronizer.Importer._base_mapper_usage">
<code class="descname"><span class="pre">_base_mapper_usage</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'import.mapper'</span></em><a class="headerlink" href="#connector.components.synchronizer.Importer._base_mapper_usage" title="Permalink to this definition">¶</a></dt>
<dd><p>usage of the component used as mapper, can be customized in sub-classes</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="connector.components.synchronizer.Deleter">
<em class="property"><span class="pre">class</span> </em><code class="descclassname"><span class="pre">connector.components.synchronizer.</span></code><code class="descname"><span class="pre">Deleter</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">work_context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/synchronizer.html#Deleter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.synchronizer.Deleter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#odoo.addons.component.core.AbstractComponent" title="odoo.addons.component.core.AbstractComponent"><code class="xref py py-class docutils literal notranslate"><span class="pre">odoo.addons.component.core.AbstractComponent</span></code></a></p>
<p>Synchronizer for deleting a record on the backend</p>
<dl class="py attribute">
<dt id="connector.components.synchronizer.Deleter._name">
<code class="descname"><span class="pre">_name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'base.deleter'</span></em><a class="headerlink" href="#connector.components.synchronizer.Deleter._name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the component</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.synchronizer.Deleter._inherit">
<code class="descname"><span class="pre">_inherit</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'base.synchronizer'</span></em><a class="headerlink" href="#connector.components.synchronizer.Deleter._inherit" title="Permalink to this definition">¶</a></dt>
<dd><p>Name or list of names of the component(s) to inherit from</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.synchronizer.Deleter._usage">
<code class="descname"><span class="pre">_usage</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'deleter'</span></em><a class="headerlink" href="#connector.components.synchronizer.Deleter._usage" title="Permalink to this definition">¶</a></dt>
<dd><p>usage of the component used as mapper, can be customized in sub-classes</p>
</dd></dl>

</dd></dl>

</div>
<span class="target" id="module-connector.components.listener"></span><div class="section" id="listeners">
<h3>Listeners<a class="headerlink" href="#listeners" title="Permalink to this headline">¶</a></h3>
<p>Listeners are Components notified when events happen.
Documentation in <a class="reference internal" href="api_event.html#module-odoo.addons.component_event.components.event" title="odoo.addons.component_event.components.event"><code class="xref py py-mod docutils literal notranslate"><span class="pre">odoo.addons.component_event.components.event</span></code></a></p>
<p>The base listener for the connectors add a method
<a class="reference internal" href="#connector.components.listener.ConnectorListener.no_connector_export" title="connector.components.listener.ConnectorListener.no_connector_export"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ConnectorListener.no_connector_export()</span></code></a> which can be used with
<code class="xref py py-func docutils literal notranslate"><span class="pre">odoo.addons.component_event.skip_if()</span></code>.</p>
<dl class="py class">
<dt id="connector.components.listener.ConnectorListener">
<em class="property"><span class="pre">class</span> </em><code class="descclassname"><span class="pre">connector.components.listener.</span></code><code class="descname"><span class="pre">ConnectorListener</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">work_context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/listener.html#ConnectorListener"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.listener.ConnectorListener" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#odoo.addons.component.core.AbstractComponent" title="odoo.addons.component.core.AbstractComponent"><code class="xref py py-class docutils literal notranslate"><span class="pre">odoo.addons.component.core.AbstractComponent</span></code></a></p>
<p>Base Backend Adapter for the connectors</p>
<dl class="py attribute">
<dt id="connector.components.listener.ConnectorListener._name">
<code class="descname"><span class="pre">_name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'base.connector.listener'</span></em><a class="headerlink" href="#connector.components.listener.ConnectorListener._name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the component</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.listener.ConnectorListener._inherit">
<code class="descname"><span class="pre">_inherit</span></code><em class="property"> <span class="pre">=</span> <span class="pre">['base.connector',</span> <span class="pre">'base.event.listener']</span></em><a class="headerlink" href="#connector.components.listener.ConnectorListener._inherit" title="Permalink to this definition">¶</a></dt>
<dd><p>Name or list of names of the component(s) to inherit from</p>
</dd></dl>

<dl class="py method">
<dt id="connector.components.listener.ConnectorListener.no_connector_export">
<code class="descname"><span class="pre">no_connector_export</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">record</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/listener.html#ConnectorListener.no_connector_export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.listener.ConnectorListener.no_connector_export" title="Permalink to this definition">¶</a></dt>
<dd><p>Return if the ‘connector_no_export’ has been set in context</p>
<p>To be used with <code class="xref py py-func docutils literal notranslate"><span class="pre">odoo.addons.component_event.skip_if()</span></code>
on Events:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">odoo.addons.component.core</span> <span class="kn">import</span> <span class="n">Component</span>
<span class="kn">from</span> <span class="nn">odoo.addons.component_event</span> <span class="kn">import</span> <span class="n">skip_if</span>


<span class="k">class</span> <span class="nc">MyEventListener</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;my.event.listener&#39;</span>
    <span class="n">_inherit</span> <span class="o">=</span> <span class="s1">&#39;base.connector.event.listener&#39;</span>
    <span class="n">_apply_on</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;magento.res.partner&#39;</span><span class="p">]</span>

    <span class="nd">@skip_if</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">no_connector_export</span><span class="p">(</span><span class="n">record</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">on_record_write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">record</span><span class="o">.</span><span class="n">with_delay</span><span class="p">()</span><span class="o">.</span><span class="n">export_record</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<span class="target" id="module-connector.components.locker"></span><dl class="py class">
<dt id="connector.components.locker.RecordLocker">
<em class="property"><span class="pre">class</span> </em><code class="descclassname"><span class="pre">connector.components.locker.</span></code><code class="descname"><span class="pre">RecordLocker</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">work_context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/locker.html#RecordLocker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.locker.RecordLocker" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#odoo.addons.component.core.Component" title="odoo.addons.component.core.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">odoo.addons.component.core.Component</span></code></a></p>
<p>Component allowing to lock record(s) for the current transaction</p>
<p>Example of usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">component</span><span class="p">(</span><span class="s1">&#39;record.locker&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">records</span><span class="p">)</span>
</pre></div>
</div>
<p>See the definition of <a class="reference internal" href="#connector.components.locker.RecordLocker.lock" title="connector.components.locker.RecordLocker.lock"><code class="xref py py-meth docutils literal notranslate"><span class="pre">lock()</span></code></a> for details.</p>
<dl class="py attribute">
<dt id="connector.components.locker.RecordLocker._name">
<code class="descname"><span class="pre">_name</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'base.record.locker'</span></em><a class="headerlink" href="#connector.components.locker.RecordLocker._name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the component</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.locker.RecordLocker._inherit">
<code class="descname"><span class="pre">_inherit</span></code><em class="property"> <span class="pre">=</span> <span class="pre">['base.connector']</span></em><a class="headerlink" href="#connector.components.locker.RecordLocker._inherit" title="Permalink to this definition">¶</a></dt>
<dd><p>Name or list of names of the component(s) to inherit from</p>
</dd></dl>

<dl class="py attribute">
<dt id="connector.components.locker.RecordLocker._usage">
<code class="descname"><span class="pre">_usage</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'record.locker'</span></em><a class="headerlink" href="#connector.components.locker.RecordLocker._usage" title="Permalink to this definition">¶</a></dt>
<dd><p>Component purpose (‘import.mapper’, …).</p>
</dd></dl>

<dl class="py method">
<dt id="connector.components.locker.RecordLocker.lock">
<code class="descname"><span class="pre">lock</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">records</span></span></em>, <em><span class="n"><span class="pre">seconds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em><span class="n"><span class="pre">ignore_retry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/connector/components/locker.html#RecordLocker.lock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#connector.components.locker.RecordLocker.lock" title="Permalink to this definition">¶</a></dt>
<dd><p>Lock the records.</p>
<p>Lock the record so we are sure that only one job is running for this
record(s) if concurrent jobs have to run a job for the same record(s).
When concurrent jobs try to work on the same record(s), the first one
will lock and proceed, the others will fail to acquire it and will be
retried later
(<code class="xref py py-exc docutils literal notranslate"><span class="pre">RetryableJobError</span></code> is raised).</p>
<p>The lock is using a <code class="docutils literal notranslate"><span class="pre">FOR</span> <span class="pre">UPDATE</span> <span class="pre">NOWAIT</span></code> so any concurrent transaction
trying FOR UPDATE/UPDATE will be rejected until the current transaction
is committed or rollbacked.</p>
<p>A classical use case for this is to prevent concurrent exports.</p>
<p>The following parameters are forwarded to the exception
<code class="xref py py-exc docutils literal notranslate"><span class="pre">RetryableJobError</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>seconds</strong> – In case of retry because the lock cannot be acquired,
in how many seconds it must be retried. If not set,
the queue_job configuration is used.</li>
<li><strong>ignore_retry</strong> – If True, the retry counter of the job will not be
increased.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-odoo.addons.component.models.collection">
<span id="components-collection-model"></span><h2>Components Collection Model<a class="headerlink" href="#module-odoo.addons.component.models.collection" title="Permalink to this headline">¶</a></h2>
<div class="section" id="collection-model">
<h3>Collection Model<a class="headerlink" href="#collection-model" title="Permalink to this headline">¶</a></h3>
<p>This is the base Model shared by all the Collections.
In the context of the Connector, a collection is the Backend.
The <cite>_name</cite> given to the Collection Model will be the name
to use in the <cite>_collection</cite> of the Components usable for the Backend.</p>
<dl class="py class">
<dt id="odoo.addons.component.models.collection.Collection">
<em class="property"><span class="pre">class</span> </em><code class="descclassname"><span class="pre">odoo.addons.component.models.collection.</span></code><code class="descname"><span class="pre">Collection</span></code><a class="reference internal" href="../_modules/odoo/addons/component/models/collection.html#Collection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#odoo.addons.component.models.collection.Collection" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">odoo.models.BaseModel</span></code></p>
<p>The model on which components are subscribed</p>
<p>It would be for instance the <code class="docutils literal notranslate"><span class="pre">backend</span></code> for the connectors.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MagentoBackend</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;magento.backend&#39;</span>  <span class="c1"># name of the collection</span>
    <span class="n">_inherit</span> <span class="o">=</span> <span class="s1">&#39;collection.base&#39;</span>


<span class="k">class</span> <span class="nc">MagentoSaleImporter</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;magento.sale.importer&#39;</span>
    <span class="n">_apply_on</span> <span class="o">=</span> <span class="s1">&#39;magento.sale.order&#39;</span>
    <span class="n">_collection</span> <span class="o">=</span> <span class="s1">&#39;magento.backend&#39;</span>  <span class="c1"># name of the collection</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">magento_id</span><span class="p">):</span>
        <span class="n">mapper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">component</span><span class="p">(</span><span class="n">usage</span><span class="o">=</span><span class="s1">&#39;import.mapper&#39;</span><span class="p">)</span>
        <span class="n">extra_mappers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">many_components</span><span class="p">(</span>
            <span class="n">usage</span><span class="o">=</span><span class="s1">&#39;import.mapper.extra&#39;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="c1"># ...</span>
</pre></div>
</div>
<p>Use it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">backend</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="p">[</span><span class="s1">&#39;magento.backend&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">browse</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">backend</span><span class="o">.</span><span class="n">work_on</span><span class="p">(</span><span class="s1">&#39;magento.sale.order&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">work</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">importer</span> <span class="o">=</span> <span class="n">work</span><span class="o">.</span><span class="n">component</span><span class="p">(</span><span class="n">usage</span><span class="o">=</span><span class="s1">&#39;magento.sale.importer&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">importer</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>See also: <a class="reference internal" href="#odoo.addons.component.core.WorkContext" title="odoo.addons.component.core.WorkContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">odoo.addons.component.core.WorkContext</span></code></a></p>
<dl class="py method">
<dt id="odoo.addons.component.models.collection.Collection.work_on">
<code class="descname"><span class="pre">work_on</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">model_name</span></span></em>, <em><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/odoo/addons/component/models/collection.html#Collection.work_on"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#odoo.addons.component.models.collection.Collection.work_on" title="Permalink to this definition">¶</a></dt>
<dd><p>Entry-point for the components, context manager</p>
<p>Start a work using the components on the model.
Any keyword argument will be assigned to the work context.
See documentation of <a class="reference internal" href="#odoo.addons.component.core.WorkContext" title="odoo.addons.component.core.WorkContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">odoo.addons.component.core.WorkContext</span></code></a>.</p>
<p>It is a context manager, so you can attach objects and clean them
at the end of the work session, such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@contextmanager</span>
<span class="nd">@api</span><span class="o">.</span><span class="n">multi</span>
<span class="k">def</span> <span class="nf">work_on</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ensure_one</span><span class="p">()</span>
    <span class="n">magento_location</span> <span class="o">=</span> <span class="n">MagentoLocation</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="c1"># We create a Magento Client API here, so we can create the</span>
    <span class="c1"># client once (lazily on the first use) and propagate it</span>
    <span class="c1"># through all the sync session, instead of recreating a client</span>
    <span class="c1"># in each backend adapter usage.</span>
    <span class="k">with</span> <span class="n">MagentoAPI</span><span class="p">(</span><span class="n">magento_location</span><span class="p">)</span> <span class="k">as</span> <span class="n">magento_api</span><span class="p">:</span>
        <span class="n">_super</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">MagentoBackend</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="c1"># from the components we&#39;ll be able to do:</span>
        <span class="c1"># self.work.magento_api</span>
        <span class="k">with</span> <span class="n">_super</span><span class="o">.</span><span class="n">work_on</span><span class="p">(</span>
                <span class="n">model_name</span><span class="p">,</span> <span class="n">magento_api</span><span class="o">=</span><span class="n">magento_api</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
                <span class="p">)</span> <span class="k">as</span> <span class="n">work</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">work</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-odoo.addons.component.exception">
<span id="components-exceptions"></span><h2>Components Exceptions<a class="headerlink" href="#module-odoo.addons.component.exception" title="Permalink to this headline">¶</a></h2>
<dl class="py exception">
<dt id="odoo.addons.component.exception.ComponentException">
<em class="property"><span class="pre">exception</span> </em><code class="descclassname"><span class="pre">odoo.addons.component.exception.</span></code><code class="descname"><span class="pre">ComponentException</span></code><a class="reference internal" href="../_modules/odoo/addons/component/exception.html#ComponentException"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#odoo.addons.component.exception.ComponentException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></a></p>
<p>Base Exception for the components</p>
</dd></dl>

<dl class="py exception">
<dt id="odoo.addons.component.exception.NoComponentError">
<em class="property"><span class="pre">exception</span> </em><code class="descclassname"><span class="pre">odoo.addons.component.exception.</span></code><code class="descname"><span class="pre">NoComponentError</span></code><a class="reference internal" href="../_modules/odoo/addons/component/exception.html#NoComponentError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#odoo.addons.component.exception.NoComponentError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#odoo.addons.component.exception.ComponentException" title="odoo.addons.component.exception.ComponentException"><code class="xref py py-class docutils literal notranslate"><span class="pre">odoo.addons.component.exception.ComponentException</span></code></a></p>
<p>No component has been found</p>
</dd></dl>

<dl class="py exception">
<dt id="odoo.addons.component.exception.SeveralComponentError">
<em class="property"><span class="pre">exception</span> </em><code class="descclassname"><span class="pre">odoo.addons.component.exception.</span></code><code class="descname"><span class="pre">SeveralComponentError</span></code><a class="reference internal" href="../_modules/odoo/addons/component/exception.html#SeveralComponentError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#odoo.addons.component.exception.SeveralComponentError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#odoo.addons.component.exception.ComponentException" title="odoo.addons.component.exception.ComponentException"><code class="xref py py-class docutils literal notranslate"><span class="pre">odoo.addons.component.exception.ComponentException</span></code></a></p>
<p>More than one component have been found</p>
</dd></dl>

</div>
<div class="section" id="components-internals">
<h2>Components Internals<a class="headerlink" href="#components-internals" title="Permalink to this headline">¶</a></h2>
<p>Low-level APIs of the Components.</p>
<span class="target" id="module-odoo.addons.component.core"></span><div class="section" id="core">
<h3>Core<a class="headerlink" href="#core" title="Permalink to this headline">¶</a></h3>
<p>Core classes for the components.
The most common classes used publicly are:</p>
<ul class="simple">
<li><a class="reference internal" href="#odoo.addons.component.core.Component" title="odoo.addons.component.core.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a></li>
<li><a class="reference internal" href="#odoo.addons.component.core.AbstractComponent" title="odoo.addons.component.core.AbstractComponent"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractComponent</span></code></a></li>
<li><a class="reference internal" href="#odoo.addons.component.core.WorkContext" title="odoo.addons.component.core.WorkContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">WorkContext</span></code></a></li>
</ul>
<dl class="py class">
<dt id="odoo.addons.component.core.ComponentDatabases">
<em class="property"><span class="pre">class</span> </em><code class="descclassname"><span class="pre">odoo.addons.component.core.</span></code><code class="descname"><span class="pre">ComponentDatabases</span></code><a class="reference internal" href="../_modules/odoo/addons/component/core.html#ComponentDatabases"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#odoo.addons.component.core.ComponentDatabases" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
<p>Holds a registry of components for each database</p>
</dd></dl>

<dl class="py class">
<dt id="odoo.addons.component.core.ComponentRegistry">
<em class="property"><span class="pre">class</span> </em><code class="descclassname"><span class="pre">odoo.addons.component.core.</span></code><code class="descname"><span class="pre">ComponentRegistry</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">cachesize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/odoo/addons/component/core.html#ComponentRegistry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#odoo.addons.component.core.ComponentRegistry" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Store all the components and allow to find them using criteria</p>
<p>The key is the <code class="docutils literal notranslate"><span class="pre">_name</span></code> of the components.</p>
<p>This is an OrderedDict, because we want to keep the registration order of
the components, addons loaded first have their components found first.</p>
<p>The <code class="xref py py-attr docutils literal notranslate"><span class="pre">ready</span></code> attribute must be set to <code class="docutils literal notranslate"><span class="pre">True</span></code> when all the components
are loaded.</p>
<dl class="py method">
<dt id="odoo.addons.component.core.ComponentRegistry.get">
<code class="descname"><span class="pre">get</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">key</span></span></em>, <em><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/odoo/addons/component/core.html#ComponentRegistry.get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#odoo.addons.component.core.ComponentRegistry.get" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="odoo.addons.component.core.ComponentRegistry.load_components">
<code class="descname"><span class="pre">load_components</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">module</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/odoo/addons/component/core.html#ComponentRegistry.load_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#odoo.addons.component.core.ComponentRegistry.load_components" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="odoo.addons.component.core.ComponentRegistry.lookup">
<code class="descname"><span class="pre">lookup</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">collection_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em><span class="n"><span class="pre">usage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em><span class="n"><span class="pre">model_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/odoo/addons/component/core.html#ComponentRegistry.lookup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#odoo.addons.component.core.ComponentRegistry.lookup" title="Permalink to this definition">¶</a></dt>
<dd><p>Find and return a list of components for a usage</p>
<p>If a component is not registered in a particular collection (no
<code class="docutils literal notranslate"><span class="pre">_collection</span></code>), it will be returned in any case (as far as
the <code class="docutils literal notranslate"><span class="pre">usage</span></code> and <code class="docutils literal notranslate"><span class="pre">model_name</span></code> match).  This is useful to share
generic components across different collections.</p>
<p>If no collection name is given, components from any collection
will be returned.</p>
<p>Then, the components of a collection are filtered by usage and/or
model. The <code class="docutils literal notranslate"><span class="pre">_usage</span></code> is mandatory on the components. When the
<code class="docutils literal notranslate"><span class="pre">_model_name</span></code> is empty, it means it can be used for every models,
and it will ignore the <code class="docutils literal notranslate"><span class="pre">model_name</span></code> argument.</p>
<p>The abstract components are never returned.</p>
<p>This is a rather low-level function, usually you will use the
high-level <a class="reference internal" href="#odoo.addons.component.core.AbstractComponent.component" title="odoo.addons.component.core.AbstractComponent.component"><code class="xref py py-meth docutils literal notranslate"><span class="pre">AbstractComponent.component()</span></code></a>,
<a class="reference internal" href="#odoo.addons.component.core.AbstractComponent.many_components" title="odoo.addons.component.core.AbstractComponent.many_components"><code class="xref py py-meth docutils literal notranslate"><span class="pre">AbstractComponent.many_components()</span></code></a> or even
<a class="reference internal" href="#odoo.addons.component.core.AbstractComponent.component_by_name" title="odoo.addons.component.core.AbstractComponent.component_by_name"><code class="xref py py-meth docutils literal notranslate"><span class="pre">AbstractComponent.component_by_name()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>collection_name</strong> – the name of the collection the component is
registered into.</li>
<li><strong>usage</strong> – the usage of component we are looking for</li>
<li><strong>model_name</strong> – filter on components that apply on this model</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="odoo.addons.component.core.WorkContext">
<em class="property"><span class="pre">class</span> </em><code class="descclassname"><span class="pre">odoo.addons.component.core.</span></code><code class="descname"><span class="pre">WorkContext</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">model_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em><span class="n"><span class="pre">collection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em><span class="n"><span class="pre">components_registry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/odoo/addons/component/core.html#WorkContext"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#odoo.addons.component.core.WorkContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Transport the context required to work with components</p>
<p>It is propagated through all the components, so any
data or instance (like a random RPC client) that need
to be propagated transversally to the components
should be kept here.</p>
<p>Including:</p>
<dl class="py attribute">
<dt id="odoo.addons.component.core.WorkContext.model_name">
<code class="descname"><span class="pre">model_name</span></code><a class="headerlink" href="#odoo.addons.component.core.WorkContext.model_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the model we are working with. It means that any lookup for a
component will be done for this model. It also provides a shortcut
as a <cite>model</cite> attribute to use directly with the Odoo model from
the components</p>
</dd></dl>

<dl class="py attribute">
<dt id="odoo.addons.component.core.WorkContext.collection">
<code class="descname"><span class="pre">collection</span></code><a class="headerlink" href="#odoo.addons.component.core.WorkContext.collection" title="Permalink to this definition">¶</a></dt>
<dd><p>The collection we are working with. The collection is an Odoo
Model that inherit from ‘collection.base’. The collection attribute
can be a record or an “empty” model.</p>
</dd></dl>

<dl class="py attribute">
<dt id="odoo.addons.component.core.WorkContext.model">
<code class="descname"><span class="pre">model</span></code><a class="headerlink" href="#odoo.addons.component.core.WorkContext.model" title="Permalink to this definition">¶</a></dt>
<dd><p>Odoo Model for <code class="docutils literal notranslate"><span class="pre">model_name</span></code> with the same Odoo
<code class="xref py py-class docutils literal notranslate"><span class="pre">Environment</span></code> than the <code class="docutils literal notranslate"><span class="pre">collection</span></code> attribute.</p>
</dd></dl>

<p>This is also the entrypoint to work with the components.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">collection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="p">[</span><span class="s1">&#39;my.collection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">browse</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">work</span> <span class="o">=</span> <span class="n">WorkContext</span><span class="p">(</span><span class="n">model_name</span><span class="o">=</span><span class="s1">&#39;res.partner&#39;</span><span class="p">,</span> <span class="n">collection</span><span class="o">=</span><span class="n">collection</span><span class="p">)</span>
<span class="n">component</span> <span class="o">=</span> <span class="n">work</span><span class="o">.</span><span class="n">component</span><span class="p">(</span><span class="n">usage</span><span class="o">=</span><span class="s1">&#39;record.importer&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Usually you will use the context manager on the <code class="docutils literal notranslate"><span class="pre">collection.base</span></code> Model:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">collection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="p">[</span><span class="s1">&#39;my.collection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">browse</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="k">with</span> <span class="n">collection</span><span class="o">.</span><span class="n">work_on</span><span class="p">(</span><span class="s1">&#39;res.partner&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">work</span><span class="p">:</span>
    <span class="n">component</span> <span class="o">=</span> <span class="n">work</span><span class="o">.</span><span class="n">component</span><span class="p">(</span><span class="n">usage</span><span class="o">=</span><span class="s1">&#39;record.importer&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>It supports any arbitrary keyword arguments that will become attributes of
the instance, and be propagated throughout all the components.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">collection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="p">[</span><span class="s1">&#39;my.collection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">browse</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="k">with</span> <span class="n">collection</span><span class="o">.</span><span class="n">work_on</span><span class="p">(</span><span class="s1">&#39;res.partner&#39;</span><span class="p">,</span> <span class="n">hello</span><span class="o">=</span><span class="s1">&#39;world&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">work</span><span class="p">:</span>
    <span class="k">assert</span> <span class="n">work</span><span class="o">.</span><span class="n">hello</span> <span class="o">==</span> <span class="s1">&#39;world&#39;</span>
</pre></div>
</div>
<p>When you need to work on a different model, a new work instance will be
created for you when you are using the high-level API. This is what
happens under the hood:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">collection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="p">[</span><span class="s1">&#39;my.collection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">browse</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="k">with</span> <span class="n">collection</span><span class="o">.</span><span class="n">work_on</span><span class="p">(</span><span class="s1">&#39;res.partner&#39;</span><span class="p">,</span> <span class="n">hello</span><span class="o">=</span><span class="s1">&#39;world&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">work</span><span class="p">:</span>
    <span class="k">assert</span> <span class="n">work</span><span class="o">.</span><span class="n">model_name</span> <span class="o">==</span> <span class="s1">&#39;res.partner&#39;</span>
    <span class="k">assert</span> <span class="n">work</span><span class="o">.</span><span class="n">hello</span> <span class="o">==</span> <span class="s1">&#39;world&#39;</span>
    <span class="n">work2</span> <span class="o">=</span> <span class="n">work</span><span class="o">.</span><span class="n">work_on</span><span class="p">(</span><span class="s1">&#39;res.users&#39;</span><span class="p">)</span>
    <span class="c1"># =&gt; spawn a new WorkContext with a copy of the attributes</span>
    <span class="k">assert</span> <span class="n">work2</span><span class="o">.</span><span class="n">model_name</span> <span class="o">==</span> <span class="s1">&#39;res.users&#39;</span>
    <span class="k">assert</span> <span class="n">work2</span><span class="o">.</span><span class="n">hello</span> <span class="o">==</span> <span class="s1">&#39;world&#39;</span>
</pre></div>
</div>
<dl class="py method">
<dt id="odoo.addons.component.core.WorkContext.env">
<em class="property"><span class="pre">property</span> </em><code class="descname"><span class="pre">env</span></code><a class="headerlink" href="#odoo.addons.component.core.WorkContext.env" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the current Odoo env</p>
<p>This is the environment of the current collection.</p>
</dd></dl>

<dl class="py method">
<dt id="id0">
<em class="property"><span class="pre">property</span> </em><code class="descname"><span class="pre">model</span></code><a class="headerlink" href="#id0" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the current Odoo model</p>
<p>This is the model of the current environment.</p>
</dd></dl>

<dl class="py method">
<dt id="odoo.addons.component.core.WorkContext.work_on">
<code class="descname"><span class="pre">work_on</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">model_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em><span class="n"><span class="pre">collection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/odoo/addons/component/core.html#WorkContext.work_on"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#odoo.addons.component.core.WorkContext.work_on" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new work context for another model keeping attributes</p>
<p>Used when one need to lookup components for another model.</p>
</dd></dl>

<dl class="py method">
<dt id="odoo.addons.component.core.WorkContext.component_by_name">
<code class="descname"><span class="pre">component_by_name</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">name</span></span></em>, <em><span class="n"><span class="pre">model_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/odoo/addons/component/core.html#WorkContext.component_by_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#odoo.addons.component.core.WorkContext.component_by_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a component by its name</p>
<p>If the component exists, an instance of it will be returned,
initialized with the current <a class="reference internal" href="#odoo.addons.component.core.WorkContext" title="odoo.addons.component.core.WorkContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">WorkContext</span></code></a>.</p>
<p>A <a class="reference internal" href="#odoo.addons.component.exception.NoComponentError" title="odoo.addons.component.exception.NoComponentError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">odoo.addons.component.exception.NoComponentError</span></code></a> is raised
if:</p>
<ul class="simple">
<li>no component with this name exists</li>
<li>the <code class="docutils literal notranslate"><span class="pre">_apply_on</span></code> of the found component does not match
with the current working model</li>
</ul>
<p>In the latter case, it can be an indication that you need to switch to
a different model, you can do so by providing the <code class="docutils literal notranslate"><span class="pre">model_name</span></code>
argument.</p>
</dd></dl>

<dl class="py method">
<dt id="odoo.addons.component.core.WorkContext.component">
<code class="descname"><span class="pre">component</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">usage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em><span class="n"><span class="pre">model_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/odoo/addons/component/core.html#WorkContext.component"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#odoo.addons.component.core.WorkContext.component" title="Permalink to this definition">¶</a></dt>
<dd><p>Find a component by usage and model for the current collection</p>
<p>It searches a component using the rules of
<a class="reference internal" href="#odoo.addons.component.core.ComponentRegistry.lookup" title="odoo.addons.component.core.ComponentRegistry.lookup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ComponentRegistry.lookup()</span></code></a>. When a component is found,
it initialize it with the current <a class="reference internal" href="#odoo.addons.component.core.WorkContext" title="odoo.addons.component.core.WorkContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">WorkContext</span></code></a> and returned.</p>
<p>A component with a <code class="docutils literal notranslate"><span class="pre">_apply_on</span></code> matching the asked <code class="docutils literal notranslate"><span class="pre">model_name</span></code>
takes precedence over a generic component without <code class="docutils literal notranslate"><span class="pre">_apply_on</span></code>.
A component with a <code class="docutils literal notranslate"><span class="pre">_collection</span></code> matching the current collection
takes precedence over a generic component without <code class="docutils literal notranslate"><span class="pre">_collection</span></code>.
This behavior allows to define generic components across collections
and/or models and override them only for a particular collection and/or
model.</p>
<p>A <a class="reference internal" href="#odoo.addons.component.exception.SeveralComponentError" title="odoo.addons.component.exception.SeveralComponentError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">odoo.addons.component.exception.SeveralComponentError</span></code></a> is
raised if more than one component match for the provided
<code class="docutils literal notranslate"><span class="pre">usage</span></code>/<code class="docutils literal notranslate"><span class="pre">model_name</span></code>.</p>
<p>A <a class="reference internal" href="#odoo.addons.component.exception.NoComponentError" title="odoo.addons.component.exception.NoComponentError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">odoo.addons.component.exception.NoComponentError</span></code></a> is raised
if no component is found for the provided <code class="docutils literal notranslate"><span class="pre">usage</span></code>/<code class="docutils literal notranslate"><span class="pre">model_name</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="odoo.addons.component.core.WorkContext.many_components">
<code class="descname"><span class="pre">many_components</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">usage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em><span class="n"><span class="pre">model_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/odoo/addons/component/core.html#WorkContext.many_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#odoo.addons.component.core.WorkContext.many_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Find many components by usage and model for the current collection</p>
<p>It searches a component using the rules of
<a class="reference internal" href="#odoo.addons.component.core.ComponentRegistry.lookup" title="odoo.addons.component.core.ComponentRegistry.lookup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ComponentRegistry.lookup()</span></code></a>. When components are found, they
initialized with the current <a class="reference internal" href="#odoo.addons.component.core.WorkContext" title="odoo.addons.component.core.WorkContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">WorkContext</span></code></a> and returned as a
list.</p>
<p>If no component is found, an empty list is returned.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="odoo.addons.component.core.MetaComponent">
<em class="property"><span class="pre">class</span> </em><code class="descclassname"><span class="pre">odoo.addons.component.core.</span></code><code class="descname"><span class="pre">MetaComponent</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">name</span></span></em>, <em><span class="n"><span class="pre">bases</span></span></em>, <em><span class="n"><span class="pre">attrs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/odoo/addons/component/core.html#MetaComponent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#odoo.addons.component.core.MetaComponent" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">type</span></code></a></p>
<p>Metaclass for Components</p>
<p>Every new <a class="reference internal" href="#odoo.addons.component.core.Component" title="odoo.addons.component.core.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a> will be added to <code class="docutils literal notranslate"><span class="pre">_modules_components</span></code>,
that will be used by the component builder.</p>
<dl class="py method">
<dt id="odoo.addons.component.core.MetaComponent.apply_on_models">
<em class="property"><span class="pre">property</span> </em><code class="descname"><span class="pre">apply_on_models</span></code><a class="headerlink" href="#odoo.addons.component.core.MetaComponent.apply_on_models" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="odoo.addons.component.core.AbstractComponent">
<em class="property"><span class="pre">class</span> </em><code class="descclassname"><span class="pre">odoo.addons.component.core.</span></code><code class="descname"><span class="pre">AbstractComponent</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">work_context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/odoo/addons/component/core.html#AbstractComponent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#odoo.addons.component.core.AbstractComponent" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Main Component Model</p>
<p>All components have a Python inheritance either on
<a class="reference internal" href="#odoo.addons.component.core.AbstractComponent" title="odoo.addons.component.core.AbstractComponent"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractComponent</span></code></a> or either on <a class="reference internal" href="#odoo.addons.component.core.Component" title="odoo.addons.component.core.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>.</p>
<p>Abstract Components will not be returned by lookups on components, however
they can be used as a base for other Components through inheritance (using
<code class="docutils literal notranslate"><span class="pre">_inherit</span></code>).</p>
<dl class="docutils">
<dt>Inheritance mechanism</dt><dd><p>The inheritance mechanism is like the Odoo’s one for Models.  Each
component has a <code class="docutils literal notranslate"><span class="pre">_name</span></code>. This is the absolute minimum in a Component
class.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyComponent</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;my.component&#39;</span>

    <span class="k">def</span> <span class="nf">speak</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="nb">print</span> <span class="n">message</span>
</pre></div>
</div>
<p>Every component implicitly inherit from the <cite>‘base’</cite> component.</p>
<p>There are two close but distinct inheritance types, which look
familiar if you already know Odoo.  The first uses <code class="docutils literal notranslate"><span class="pre">_inherit</span></code> with
an existing name, the name of the component we want to extend.  With
the following example, <code class="docutils literal notranslate"><span class="pre">my.component</span></code> is now able to speak and to
yell.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyComponent</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>  <span class="c1"># name of the class does not matter</span>
    <span class="n">_inherit</span> <span class="o">=</span> <span class="s1">&#39;my.component&#39;</span>

    <span class="k">def</span> <span class="nf">yell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="nb">print</span> <span class="n">message</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
</pre></div>
</div>
<p>The second has a different <code class="docutils literal notranslate"><span class="pre">_name</span></code>, it creates a new component,
including the behavior of the inherited component, but without
modifying it. In the following example, <code class="docutils literal notranslate"><span class="pre">my.component</span></code> is still able
to speak and to yell (brough by the previous inherit), but not to
sing.  <code class="docutils literal notranslate"><span class="pre">another.component</span></code> is able to speak, to yell and to sing.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">AnotherComponent</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;another.component&#39;</span>
    <span class="n">_inherit</span> <span class="o">=</span> <span class="s1">&#39;my.component&#39;</span>

    <span class="k">def</span> <span class="nf">sing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="nb">print</span> <span class="n">message</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt>Registration and lookups</dt><dd><p>It is handled by 3 attributes on the class:</p>
<dl class="docutils">
<dt>_collection</dt><dd>The name of the collection where we want to register the
component.  This is not strictly mandatory as a component can be
shared across several collections. But usually, you want to set a
collection to segregate the components for a domain.  A collection
can be for instance <code class="docutils literal notranslate"><span class="pre">magento.backend</span></code>. It is also the name of a
model that inherits from <code class="docutils literal notranslate"><span class="pre">collection.base</span></code>.  See also
<a class="reference internal" href="#odoo.addons.component.core.WorkContext" title="odoo.addons.component.core.WorkContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">WorkContext</span></code></a> and
<a class="reference internal" href="#odoo.addons.component.models.collection.Collection" title="odoo.addons.component.models.collection.Collection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Collection</span></code></a>.</dd>
<dt>_apply_on</dt><dd>List of names or name of the Odoo model(s) for which the component
can be used.  When not set, the component can be used on any model.</dd>
<dt>_usage</dt><dd>The collection and the model (<code class="docutils literal notranslate"><span class="pre">_apply_on</span></code>) will help to filter
the candidate components according to our working context (e.g. I’m
working on <code class="docutils literal notranslate"><span class="pre">magento.backend</span></code> with the model
<code class="docutils literal notranslate"><span class="pre">magento.res.partner</span></code>).  The usage will define <strong>what</strong> kind of
task the component we are looking for serves to. For instance, it
might be <code class="docutils literal notranslate"><span class="pre">record.importer</span></code>, <code class="docutils literal notranslate"><span class="pre">export.mapper`</span></code>… but you can be
as creative as you want.</dd>
</dl>
<p>Now, to get a component, you’ll likely use
<a class="reference internal" href="#odoo.addons.component.core.WorkContext.component" title="odoo.addons.component.core.WorkContext.component"><code class="xref py py-meth docutils literal notranslate"><span class="pre">WorkContext.component()</span></code></a> when you start to work with components
in your flow, but then from within your components, you are more
likely to use one of:</p>
<ul class="simple">
<li><a class="reference internal" href="#odoo.addons.component.core.AbstractComponent.component" title="odoo.addons.component.core.AbstractComponent.component"><code class="xref py py-meth docutils literal notranslate"><span class="pre">component()</span></code></a></li>
<li><a class="reference internal" href="#odoo.addons.component.core.AbstractComponent.many_components" title="odoo.addons.component.core.AbstractComponent.many_components"><code class="xref py py-meth docutils literal notranslate"><span class="pre">many_components()</span></code></a></li>
<li><a class="reference internal" href="#odoo.addons.component.core.AbstractComponent.component_by_name" title="odoo.addons.component.core.AbstractComponent.component_by_name"><code class="xref py py-meth docutils literal notranslate"><span class="pre">component_by_name()</span></code></a> (more rarely though)</li>
</ul>
<p>Declaration of some Components can look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">FooBar</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;foo.bar.collection&#39;</span>
    <span class="n">_inherit</span> <span class="o">=</span> <span class="s1">&#39;collection.base&#39;</span>  <span class="c1"># this inherit is required</span>


<span class="k">class</span> <span class="nc">FooBarBase</span><span class="p">(</span><span class="n">AbstractComponent</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;foo.bar.base&#39;</span>
    <span class="n">_collection</span> <span class="o">=</span> <span class="s1">&#39;foo.bar.collection&#39;</span>  <span class="c1"># name of the model above</span>


<span class="k">class</span> <span class="nc">Foo</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;foo&#39;</span>
    <span class="n">_inherit</span> <span class="o">=</span> <span class="s1">&#39;foo.bar.base&#39;</span>  <span class="c1"># we will inherit the _collection</span>
    <span class="n">_apply_on</span> <span class="o">=</span> <span class="s1">&#39;res.users&#39;</span>
    <span class="n">_usage</span> <span class="o">=</span> <span class="s1">&#39;speak&#39;</span>

    <span class="k">def</span> <span class="nf">utter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="nb">print</span> <span class="n">message</span>


<span class="k">class</span> <span class="nc">Bar</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;bar&#39;</span>
    <span class="n">_inherit</span> <span class="o">=</span> <span class="s1">&#39;foo.bar.base&#39;</span>  <span class="c1"># we will inherit the _collection</span>
    <span class="n">_apply_on</span> <span class="o">=</span> <span class="s1">&#39;res.users&#39;</span>
    <span class="n">_usage</span> <span class="o">=</span> <span class="s1">&#39;yell&#39;</span>

    <span class="k">def</span> <span class="nf">utter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="nb">print</span> <span class="n">message</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;!!!&#39;</span>


<span class="k">class</span> <span class="nc">Vocalizer</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;vocalizer&#39;</span>
    <span class="n">_inherit</span> <span class="o">=</span> <span class="s1">&#39;foo.bar.base&#39;</span>
    <span class="n">_usage</span> <span class="o">=</span> <span class="s1">&#39;vocalizer&#39;</span>
    <span class="c1"># can be used for any model</span>

    <span class="k">def</span> <span class="nf">vocalize</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">component</span><span class="p">(</span><span class="n">usage</span><span class="o">=</span><span class="n">action</span><span class="p">)</span><span class="o">.</span><span class="n">utter</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</pre></div>
</div>
<p>And their usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">coll</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="p">[</span><span class="s1">&#39;foo.bar.collection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">browse</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">coll</span><span class="o">.</span><span class="n">work_on</span><span class="p">(</span><span class="s1">&#39;res.users&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">work</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">vocalizer</span> <span class="o">=</span> <span class="n">work</span><span class="o">.</span><span class="n">component</span><span class="p">(</span><span class="n">usage</span><span class="o">=</span><span class="s1">&#39;vocalizer&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">vocalizer</span><span class="o">.</span><span class="n">vocalize</span><span class="p">(</span><span class="s1">&#39;speak&#39;</span><span class="p">,</span> <span class="s1">&#39;hello world&#39;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">hello world</span>
<span class="gp">... </span>    <span class="n">vocalizer</span><span class="o">.</span><span class="n">vocalize</span><span class="p">(</span><span class="s1">&#39;yell&#39;</span><span class="p">,</span> <span class="s1">&#39;hello world&#39;</span><span class="p">)</span>
<span class="go">HELLO WORLD!!!</span>
</pre></div>
</div>
</dd>
</dl>
<p>Hints:</p>
<ul class="simple">
<li>If you want to create components without <code class="docutils literal notranslate"><span class="pre">_apply_on</span></code>, choose a
<code class="docutils literal notranslate"><span class="pre">_usage</span></code> that will not conflict other existing components.</li>
<li>Unless this is what you want and in that case you use
<a class="reference internal" href="#odoo.addons.component.core.AbstractComponent.many_components" title="odoo.addons.component.core.AbstractComponent.many_components"><code class="xref py py-meth docutils literal notranslate"><span class="pre">many_components()</span></code></a> which will return all components for a usage
with a matching or a not set <code class="docutils literal notranslate"><span class="pre">_apply_on</span></code>.</li>
<li>It is advised to namespace the names of the components (e.g.
<code class="docutils literal notranslate"><span class="pre">magento.xxx</span></code>) to prevent conflicts between addons.</li>
</ul>
<dl class="py method">
<dt id="odoo.addons.component.core.AbstractComponent.collection">
<em class="property"><span class="pre">property</span> </em><code class="descname"><span class="pre">collection</span></code><a class="headerlink" href="#odoo.addons.component.core.AbstractComponent.collection" title="Permalink to this definition">¶</a></dt>
<dd><p>Collection we are working with</p>
</dd></dl>

<dl class="py method">
<dt id="odoo.addons.component.core.AbstractComponent.env">
<em class="property"><span class="pre">property</span> </em><code class="descname"><span class="pre">env</span></code><a class="headerlink" href="#odoo.addons.component.core.AbstractComponent.env" title="Permalink to this definition">¶</a></dt>
<dd><p>Current Odoo environment, the one of the collection record</p>
</dd></dl>

<dl class="py method">
<dt id="odoo.addons.component.core.AbstractComponent.model">
<em class="property"><span class="pre">property</span> </em><code class="descname"><span class="pre">model</span></code><a class="headerlink" href="#odoo.addons.component.core.AbstractComponent.model" title="Permalink to this definition">¶</a></dt>
<dd><p>The model instance we are working with</p>
</dd></dl>

<dl class="py method">
<dt id="odoo.addons.component.core.AbstractComponent.component_by_name">
<code class="descname"><span class="pre">component_by_name</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">name</span></span></em>, <em><span class="n"><span class="pre">model_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/odoo/addons/component/core.html#AbstractComponent.component_by_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#odoo.addons.component.core.AbstractComponent.component_by_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a component by its name</p>
<p>Shortcut to meth:<cite>~WorkContext.component_by_name</cite></p>
</dd></dl>

<dl class="py method">
<dt id="odoo.addons.component.core.AbstractComponent.component">
<code class="descname"><span class="pre">component</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">usage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em><span class="n"><span class="pre">model_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/odoo/addons/component/core.html#AbstractComponent.component"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#odoo.addons.component.core.AbstractComponent.component" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a component</p>
<p>Shortcut to meth:<cite>~WorkContext.component</cite></p>
</dd></dl>

<dl class="py method">
<dt id="odoo.addons.component.core.AbstractComponent.many_components">
<code class="descname"><span class="pre">many_components</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">usage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em><span class="n"><span class="pre">model_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/odoo/addons/component/core.html#AbstractComponent.many_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#odoo.addons.component.core.AbstractComponent.many_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Return several components</p>
<p>Shortcut to meth:<cite>~WorkContext.many_components</cite></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="odoo.addons.component.core.Component">
<em class="property"><span class="pre">class</span> </em><code class="descclassname"><span class="pre">odoo.addons.component.core.</span></code><code class="descname"><span class="pre">Component</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">work_context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/odoo/addons/component/core.html#Component"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#odoo.addons.component.core.Component" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#odoo.addons.component.core.AbstractComponent" title="odoo.addons.component.core.AbstractComponent"><code class="xref py py-class docutils literal notranslate"><span class="pre">odoo.addons.component.core.AbstractComponent</span></code></a></p>
<p>Concrete Component class</p>
<p>This is the class you inherit from when you want your component to
be registered in the component collections.</p>
<p>Look in <a class="reference internal" href="#odoo.addons.component.core.AbstractComponent" title="odoo.addons.component.core.AbstractComponent"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractComponent</span></code></a> for more details.</p>
</dd></dl>

</div>
<span class="target" id="module-odoo.addons.component.builder"></span><div class="section" id="components-builder">
<h3>Components Builder<a class="headerlink" href="#components-builder" title="Permalink to this headline">¶</a></h3>
<p>Build the components at the build of a registry.</p>
<dl class="py class">
<dt id="odoo.addons.component.builder.ComponentBuilder">
<em class="property"><span class="pre">class</span> </em><code class="descclassname"><span class="pre">odoo.addons.component.builder.</span></code><code class="descname"><span class="pre">ComponentBuilder</span></code><a class="reference internal" href="../_modules/odoo/addons/component/builder.html#ComponentBuilder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#odoo.addons.component.builder.ComponentBuilder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">odoo.models.BaseModel</span></code></p>
<p>Build the component classes</p>
<p>And register them in a global registry.</p>
<p>Every time an Odoo registry is built, the know components are cleared and
rebuilt as well.  The Component classes are built using the same mechanism
than Odoo’s Models: a final class is created, taking every Components with
a <code class="docutils literal notranslate"><span class="pre">_name</span></code> and applying Components with an <code class="docutils literal notranslate"><span class="pre">_inherits</span></code> upon them.</p>
<p>The final Component classes are registered in global registry.</p>
<p>This class is an Odoo model, allowing us to hook the build of the
components at the end of the Odoo’s registry loading, using
<code class="docutils literal notranslate"><span class="pre">_register_hook</span></code>. This method is called after all modules are loaded, so
we are sure that we have all the components Classes and in the correct
order.</p>
<dl class="py method">
<dt id="odoo.addons.component.builder.ComponentBuilder.build_registry">
<code class="descname"><span class="pre">build_registry</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">components_registry</span></span></em>, <em><span class="n"><span class="pre">states</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em><span class="n"><span class="pre">exclude_addons</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/odoo/addons/component/builder.html#ComponentBuilder.build_registry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#odoo.addons.component.builder.ComponentBuilder.build_registry" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="odoo.addons.component.builder.ComponentBuilder.load_components">
<code class="descname"><span class="pre">load_components</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">module</span></span></em>, <em><span class="n"><span class="pre">components_registry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/odoo/addons/component/builder.html#ComponentBuilder.load_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#odoo.addons.component.builder.ComponentBuilder.load_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Build every component known by MetaComponent for an odoo module</p>
<p>The final component (composed by all the Component classes in this
module) will be pushed into the registry.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>module</strong> (<em>str | unicode</em>) – the name of the addon for which we want to load
the components</li>
<li><strong>registry</strong> (<a class="reference internal" href="#odoo.addons.component.core.ComponentRegistry" title="odoo.addons.component.core.ComponentRegistry"><code class="xref py py-class docutils literal notranslate"><span class="pre">ComponentRegistry</span></code></a>) – the registry in which we want to put the Component</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../_sources/api/api_components.rst.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2013, Camptocamp SA.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.5.4.<br/>
    </p>
  </div>
</footer>
  </body>
</html>